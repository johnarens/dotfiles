/* Generated at Mon Mar 20 13:49:35 CDT 2017 */
var GQueues=function(){var ah="https://www.gqueues.com/gmail?action=getAuth";var a5="https://www.gqueues.com/help/gmailExtension";var B=20;var w=20;var bY=5;var I;var bn="";var D;var bw;var ar;var bl;var bW;var M;var a9;var f;var G;var c;var af;var bT;var l;var a0;var Y;var aP;var U;var a2;var A;var aI;var bP;var b0;var an;var bx;var ae;var bs;var z;var o;var q;var bq;var R;var a6;var k;var aY;var s;var au;var E;var n;var aw;var bD="";var aQ;var aS;var P;var aR;var bM;var bR="";var aK="";var X="";var bt="";var bV="";var bI;var bo;var x;var Z;var bB;var al;var bb;var aW;var N;var ag;var g;var aM;var aV;var bL;var aL=false;var aZ=null;var p=false;var T=null;var aH;var J;var bU;bw=["<div id='gqGmailPopup'>","<div class='gq-header'>","<img width='122px' height='30px' src='"+chrome.extension.getURL("images/gqLogo.png")+"' />","<img id='gqSettingsBtn' src='"+chrome.extension.getURL("images/gmailSettingsBtn.png")+"' />","</div>","<div id='gqContentPanel' class='gq-panel'>","<div class='gq-content'>","<table id='gqContentTable' class='gq-modern-input-styles' cellspacing='0' cellpadding='0' width='100%'>","<tbody>","<tr>","<td width='15%'><label for='gqQueueDropdown'>Queue</label></td>","<td width='85%'><select id='gqQueueDropdown' tabindex='1'></select><img id='gqRefreshBtn' src='"+chrome.extension.getURL("images/refreshBtn.png")+"' /></td>","</tr>","<tr>","<td><label for='gqDescription'>Description</label></td>","<td><input id='gqDescription' type='text' maxlength='250' tabindex='2' /></td>","</tr>","<tr>","<td class='top-align'><label for='gqNotes'>Notes</label></td>","<td><textarea id='gqNotes' tabindex='3' ></textarea></td>","</tr>","<tr>","<td></td>","<td>","<div id='gqAttachmentsWrapper'>","<div id='gqEmailLinkWrap'><input id='gqEmailLink' type='checkbox' tabindex='4' /><span>Link to this email</span></div>","<div id='gqEmailOriginalWrap'><input id='gqEmailOriginal' type='checkbox' tabindex='5' /><span>Attach this email</span></div>","</div>","</td>","</tr>","<tr>","<td class='gq-label-tags'><label for='gqAddTag'>Tags</label></td>","<td id='gqTags' class='gq-value gq-i-tags-row'><div id='gqAddTag'>+ add tag</div></td>","</tr>","<tr>","<td class='gq-label-assign'><label for='gqAddAssignment'>Assignments</label></td>","<td id='gqAssignments' class='gq-value'>","<div id='gqAddAssignment'>+ assign to</div>","<table cellpadding='0' cellspacing='0'><tbody></tbody></table>","</td>","</tr>","<tr>","<td colspan='2' class='gq-date-heading'>","<div id='gqDateReminder' class='gq-hidden'></div>","<input type='checkbox' id='gqDateCheckbox' tabindex='6' /><span id='gqDueDateLabel'>Due Date</span><span id='gqDateSummary'></span>","</td>","</tr>","</tbody>","</table>","<div id='gqDateTableRow' class='gq-hidden'>","<div id='gqCalendarDialogModern' class=''>","<div class=''>","<div class='gq-right-panel'>","<div id='gqTimeInputMenu'></div>","<div id='gqDurationInputMenu'></div>","<div id='gqReminderInputMenu'></div>","<div id='gqReminderAmountInputMenu'></div>","</div>","<div class='gq-left-panel'>","<div id='gqDateInputMenu'></div>","<div id='gqCalendar' class='gq-modern-calendar'></div>","</div>","</div>","</div>","</div>","<div class='gq-clear'></div>","<div id='gqSpacer' class='gq-hidden'></div>","<div id='gqAssignFilter' class='gq-hidden'>","<div class='gq-tf-content gq-modern-input-styles'>","<table id='gqAssignTemplate'><tbody>","<tr class='gq-i-assignment' key=''>","<td class='gq-a-icon'></td>","<td class='gq-a-name' title=''></td>","<td class='gq-a-comment' config='{ name:'comments' }'></td>","</tr>","</tbody></table>","<div class='gq-tf-error gq-hidden'>Invalid email</div>","<div class='gq-tf-input'><input type='text' value='type email / add' /></div>","<ul>","<li class='gq-tf-create'></li>","<li class='gq-tf-separator'></li>","<li class='gq-tf-manage'>Settings...</li>","</ul>","</div>","</div>","<div id='gqTagFilter' class='gq-hidden'>","<div class='gq-tf-content gq-modern-input-styles'>","<div id='gqTagTemplate'>","<div class='gq-i-tag'><span title='Show all items with this tag' class='gq-i-tag-content'>{{ tag.name|escape }}</span><span title='Remove tag from this item' class='gq-i-tag-delete gq-invisible'>X</span></div>   ","</div>","<div class='gq-tf-input'><input type='text' value='create / add' placeholder='create / add' /></div>","<ul>","<li class='gq-tf-create'></li>","<li class='gq-tf-separator'></li>","<li class='gq-tf-manage'>Manage tags</li>","</ul>","</div>","</div>","</div>","<div class='gq-footer'>","<div id='gqEmail'></div>","<button type='button' id='gqCreateBtn' class='gq-button gq-button-two' tabindex='12' >Create Task</button>","<button type='button' id='gqCloseBtn' class='gq-button' tabindex='13' >Cancel</button>","</div>","</div>","<div id='gqSettingsPanel' class='gq-panel gq-hidden'>","<div>","<h2>Account</h2>","<div id='gqLinkedAccount'>This extension is currently linked to your test@gmail.com GQueues acccount.</div>","<div>","<button type='button' id='gqDisconnectBtn' class='gq-button'>Disconnect</button>","<button type='button' id='gqReauthorizeBtn' class='gq-button'>Reauthorize Gmail Access</button>","</div>","<div id='gqEmailSettingsWrapper' class='gq-setting-wrapper'>","<h2>Default Email Settings</h2>","<div id='gqDefaultEmailLinkWrap'><input id='gqDefaultEmailLink' type='checkbox' /><span>Link to this email</span></div>","<div id='gqDefaultEmailOriginalWrap'><input id='gqDefaultEmailOriginal' type='checkbox' /><span>Attach this email</span></div>","</div>","<div class='gq-setting-wrapper'>","<h2>Keyboard Shortcut</h2>","<div id='gqKeyboardShortcutWrap'><input id='gqKeyboardShortcutInput' type='checkbox' /><span><strong>shift-t</strong> to create task</span></div>","</div>","<div class='gq-clear'></div>","<div class='gq-setting-wrapper'>","<h2>Default Queue</h2>","<div><select id='gqDefaultQueueDropdown'></select></div>","</div>","<button type='button' id='gqSettingsDoneBtn' class='gq-button'>Done</button>","</div>","</div>","<div id='gqLoadingPanel' class='gq-panel gq-hidden'>","<div><span></span></div>","</div>","<div id='gqErrorPanel' class='gq-panel gq-hidden'>","<p>There was an error creating the task.</p>","<p>Please try again later.</p>","<p><button type='button' id='gqErrorCloseBtn' class='gq-button'>Close</button></p>","</div>","<div id='gqUnauthorizedPanel' class='gq-panel gq-hidden'>","<p>This extension is no longer connected to your GQueues account.</p>","<p><button type='button' id='gqReconnectBtn' class='gq-button'>Reconnect</button></p>","</div>","</div>"];bw=bw.join("");ar=["<div id='gqWelcomePopup'>","<h2>GQueues for Gmail Installed</h2>","<div class='content'>","When reading an email, turn it into a task by clicking the new <strong>Create Task</strong> button.","</div>","<div class='img-wrapper'>","<img width='560px' height='185px' src='"+chrome.extension.getURL("images/welcome.gif")+"' />","</div>","<div class='gq-footer'>","<button type='button' id='gqWelcomeLearnBtn' class='gq-button gq-button-two'>Learn More</button>","<button type='button' id='gqWelcomeCloseBtn' class='gq-button'>Close</button>","</div>","</div>"];ar=ar.join("");bl=["<div id='gqWrongPopup'>","<h2>GQueues for Gmail Unavailable</h2>","<div class='content'>","<p>You are currently signed in as <span class='curr-email'></span>.</p>","<p>However, GQueues for Gmail is linked to <span class='linked-email'></span>, so the extension is not currently available.</p>","<p><a href='https://www.gqueues.com/help/gmailExtension#multipleAccounts' target='_blank'>Setup Chrome Profiles</a> to use the extension with multiple Gmail and GQueues accounts.</p>","</div>","<div class='gq-footer'>","<button type='button' id='gqWrongCloseBtn' class='gq-button'>Close</button>","</div>","</div>"];bl=bl.join("");var j=function(b8){if(b8>B){return}var b9=$('div[gh="mtb"] > div');if(b9.find("> div > div").length===0){setTimeout(function(){j(b8+1)},100);return}var b5=b9.find("> div:first");var b4=b5.get(0).className.replace(" ",".");if(!b4){return}D=b9.find("div."+b4+":last");if(b9.find('span[role="checkbox"]').length===0){$("#gqAddTask").remove();D.before("<div id='gqAddTask' class='' data-tooltip='Create GQueues Task'><span>Create Task</span></div>");I=$("#gqAddTask");try{var b7=D.find('div[role="button"]');var b3=b7.get(0).className;var ca=b7.find("span:first");var b2=ca.get(0).className;if(!bn){bk()}I.addClass(b3);I.find("span").addClass(b2);I.hover(function(){if(bn){I.removeClass().addClass(bn)}},function(){I.removeClass().addClass(b3)})}catch(b6){}aJ(b3,0);I.click(function(){r()})}};var aJ=function(b4,b2){if(b2>bY){return}var b3=$(".boomerang-button");if(b3.length===0){setTimeout(function(){aJ(b4,b2+1)},250);return}b3.addClass(b4)};var ab=function(){$(document).unbind("keydown.gqBtn");if(Z){$(document).bind("keydown.gqBtn",function(b2){if($("#gqAddTask").length===0){$(document).unbind("keydown.gqBtn");return}if($("#gqGmailPopup").length>0){return}var b3=$(b2.target);if(b3.prop("nodeName")==="TEXTAREA"||b3.prop("nodeName")==="INPUT"||b3.attr("contentEditable")){return}if(b2.keyCode===84&&b2.shiftKey){r();return false}})}};var aF=function(){chrome.runtime.onMessage.addListener(function(b4,b3,b2){if(b4.action=="locationUpdated"){j(0);ab();return}if(b4.action=="showAddTaskPopup"){a1(function(b5){if(b5){bO();r(true)}});return}if(b4.action=="setKeyboardShortcutSetting"){aD();return}if(b4.action=="loadData"){aA(b4.userData);bf();return}if(b4.action=="createUnauthorized"){ao(b4.data);return}if(b4.action=="showError"){ap(b4.errorMsg);return}if(b4.action=="createSuccess"){aB(b4.data);return}})};var r=function(b2){if(aL){bF();return}if(T===null){chrome.runtime.sendMessage({action:"showLoginWindow"},function(b3){});return}ba(b2)};var ba=function(b2){$("#gqGmailPopup").remove();$("body").append(bw);bW=$("#gqGmailPopup");M=$("#gqContentPanel");a9=$("#gqErrorPanel");f=$("#gqUnauthorizedPanel");G=$("#gqLoadingPanel");c=$("#gqSettingsPanel");af=G.find("div");bT=$("#gqEmail");l=$("#gqCloseBtn");a0=$("#gqCreateBtn");aP=$("#gqReconnectBtn");Y=$("#gqErrorCloseBtn");U=$("#gqDescription");a2=$("#gqNotes");A=$("#gqQueueDropdown");aI=$("#gqRefreshBtn");bP=$("#gqSettingsBtn");b0=$("#gqSettingsDoneBtn");an=$("#gqDisconnectBtn");bx=$("#gqReauthorizeBtn");ae=$("#gqLinkedAccount");bs=$("#gqDefaultEmailLink");z=$("#gqDefaultEmailOriginal");o=$("#gqDefaultQueueDropdown");q=$("#gqKeyboardShortcutInput");bq=$("#gqCalendar");R=$("#gqTags");a6=$("#gqAssignments");k=$("#gqSpacer");aw=$("#gqDateCheckbox");bB=$("#gqEmailLink");al=$("#gqEmailOriginal");bb=$("#gqDueDateLabel");m();K();$(window).bind("resize.gqExt",K);bW.draggable({handle:".gq-header"});aN();H();aj();N=window.location.href;bT.html(T.email);l.click(t);l.blur(function(){A.focus()});a0.click(aX);aP.click(r);Y.click(t);bB.click(bE);al.click(aO);$("#gqAttachmentsWrapper span").click(ad);bb.click(function(){aw.trigger("click")});aI.click(Q);bP.click(bJ);b0.click(aE);an.click(S);bx.click(az);bs.click(a);z.click(L);o.change(bd);q.click(b);aW=$('div[role="main"] h2:first').text();U.val(aW);bN();bZ();if(Z){q.prop("checked",true);$("#gqKeyboardShortcutWrap").addClass("gq-checked")}else{q.prop("checked",false);$("#gqKeyboardShortcutWrap").removeClass("gq-checked")}chrome.runtime.sendMessage({action:"recordShowEvent"},function(b3){});d();if(b2){Q()}else{bf();e()}};var t=function(){$("#gqGmailPopup").remove();$(window).unbind("resize.gqExt");$(document).unbind("keydown.gqEscape")};var m=function(){var b3=I.offset();var b2=$('div[gh="mtb"]').offset();bW.css("top",Math.round(b3.top+45));bW.css("left",Math.round(b2.left+6))};var K=function(){var b3=40;var b2=$(window).height()-M.offset()["top"]-b3;M.css("max-height",b2)};var d=function(){$(document).bind("keydown.gqEscape",function(){if(event.keyCode===27){t()}});U.bind("keydown.gqExt",function(b2){if(b2.keyCode===13){aX()}})};var Q=function(){a3();chrome.runtime.sendMessage({action:"getAccountData"},function(b2){})};var e=function(){chrome.storage.local.get("GQ_STORAGE_USER_DATA_KEY",function(b2){_userDataObj=b2.GQ_STORAGE_USER_DATA_KEY;aA(_userDataObj)})};var aA=function(b2){if(b2===undefined||b2===null){return}aq(A,b2);aq(o,b2);bz(b2);be(b2);a8(b2)};var aq=function(b5,b4){var b2=[];var b3;b2.push('<option value="" selected="selected">Inbox</option>');$.each(b4.categories,function(b6,b7){b3='<optgroup label="'+b7.name+'">';b2.push(b3);$.each(b7.queues,function(b9,b8){b3='<option value="'+b8.key+'">'+b8.name+"</option>";b2.push(b3)});b3="</optgroup>";b2.push(b3)});$.each(b4.friendships,function(b7,b6){b3='<optgroup label="'+b6.name+'">';b2.push(b3);$.each(b6.queues,function(b9,b8){if(b8.collaboration){disabledText=""}else{disabledText=" disabled='disabled' "}b3='<option value="'+b8.key+'"'+disabledText+">"+b8.name+"</option>";b2.push(b3)});b3="</optgroup>";b2.push(b3)});b5.html(b2.join(""));aT(b5)};var aT=function(b2){chrome.storage.sync.get("GQ_STORAGE_DEFAULT_QUEUE_KEY",function(b3){var b4=b3.GQ_STORAGE_DEFAULT_QUEUE_KEY;if(b4===undefined||b4===null){return}b2.find("option").each(function(){if(this.value===b4){b2.val(b4);return false}})})};var bN=function(){chrome.storage.sync.get("GQ_STORAGE_EMAIL_LINK_KEY",function(b2){var b3=b2.GQ_STORAGE_EMAIL_LINK_KEY;if(b3===undefined||b3===null||!b3){bI=false;bs.prop("checked",false);bB.prop("checked",false);$("#gqEmailLinkWrap").removeClass("gq-checked");$("#gqDefaultEmailLinkWrap").removeClass("gq-checked")}else{bI=true;bs.prop("checked",true);bB.prop("checked",true);$("#gqEmailLinkWrap").addClass("gq-checked");$("#gqDefaultEmailLinkWrap").addClass("gq-checked")}})};var aD=function(){chrome.storage.sync.get("GQ_STORAGE_KEYBOARD_SHORTCUT_KEY",function(b2){var b3=b2.GQ_STORAGE_KEYBOARD_SHORTCUT_KEY;if(b3===undefined||b3===null||!b3){Z=false;ab()}else{Z=true;ab()}})};var bZ=function(){chrome.storage.sync.get("GQ_STORAGE_EMAIL_ORIGINAL_KEY",function(b2){var b3=b2.GQ_STORAGE_EMAIL_ORIGINAL_KEY;if(b3===undefined||b3===null||!b3){bo=false;z.prop("checked",false);al.prop("checked",false);$("#gqEmailOriginalWrap").removeClass("gq-checked");$("#gqDefaultEmailOriginalWrap").removeClass("gq-checked")}else{bo=true;z.prop("checked",true);al.prop("checked",true);$("#gqEmailOriginalWrap").addClass("gq-checked");$("#gqDefaultEmailOriginalWrap").addClass("gq-checked")}})};var aX=function(){U.blur();a3();var cb=U.val();var b7=a2.val();cb=GQueues.Util.htmlEscape(cb);cb=GQueues.Util.convertLineBreaks(cb);cb=GQueues.Util.convertLinks(cb);if(b7){b7=GQueues.Util.htmlEscape(b7);b7=GQueues.Util.convertLinks(b7)}var b3={action:"createTask",key:A.val(),description:cb,notes:b7};var ce=R.find(".gq-i-tag-content");if(ce.length>0){counter=1;ce.each(function(){b3["tags"+counter]=$(this).text();counter++})}var b2=a6.find(".gq-a-name");if(b2.length>0){counter=1;b2.each(function(){b3["assignments"+counter]=$(this).attr("title");counter++})}if(aw.prop("checked")){var b9=bq.datepicker("getDate");var b8=$.datepicker.formatDate("yy-mm-dd",b9);var ca="No";if(aK){b8+=" "+aK+":"+X;ca="Yes"}b3.dueDate=b8;b3.dueTime=ca;if(bV){b3.reminderType=bV;b3.reminderAmount=bt}b3.duration=bD}var cd=N.split("#")[0].split("?")[0];var b4="";var b5=N.match(/&th=.*?&/i);if(b5){b4=b5[0].substring(4,b5[0].length-1)}else{var b6=N.split("/");b4=b6[b6.length-1]}if(!b4){ap("There was an error creating the task.");return}b3.threadId=b4;if(bB.prop("checked")){b3.emailLink="true"}if(al.prop("checked")){var cc=cd+"?view=pt&search=inbox&th="+b4;$.ajax({type:"GET",cache:false,url:cc,success:function(cf){cf=cf.replace('"//www','"https://www');b3.emailHtml=cf;b3.emailName=aW;b3.addAttachments=true;chrome.runtime.sendMessage({action:"createTask",postData:b3},function(cg){})}})}else{chrome.runtime.sendMessage({action:"createTask",postData:b3},function(cf){})}};var aB=function(b2){t()};var ao=function(){T=null;bg()};var ad=function(b2){var b3=$(b2.target);b3.parent().find("input").trigger("click")};var bE=function(b2){var b3=$(b2.target);b3.parent().toggleClass("gq-checked")};var aO=function(b2){bE(b2);var b3=$(b2.target);if(b3.prop("checked")){bH(b3)}};var bH=function(b2){if(p){bO(function(){bH(b2)});return}if(aZ!==null){p=true;b2.prop("checked",false);b2.parent().removeClass("gq-checked");window.open(aZ,"_blank","width=600, height=600");return}};var H=function(){GQueues.AssignFilter.init();$("#gqAddAssignment").click(function(b4){var b5=$(b4.target);GQueues.AssignFilter.setCallback(ay);GQueues.AssignFilter.toggle(b5);var b7=b5.position();var b6=$("#gqAssignFilter");b6.css("top",Math.round(b7.top+b5.outerHeight()));b6.css("left",Math.round(b7.left-b6.outerWidth()+b5.outerWidth()));if(!b6.hasClass("gq-hidden")){var b3=b6.height();var b2=b6.position().top+b3-bW.height();if(b2>0){k.height(b2+20).removeClass("gq-hidden");$("html").bind("click.assignFilter",function(b8){if(b5.parents("#gqAssignFilter").length===0){k.addClass("gq-hidden")}})}}else{k.addClass("gq-hidden")}return false});a6.click(function(b2){var b3=$(b2.target);if(b3.hasClass("gq-a-delete-hover")){b3.parents(".gq-i-assignment:first").remove()}});a6.mouseover(function(b2){var b3=$(b2.target);if(b3.hasClass("gq-a-icon")){b3.addClass("gq-a-delete-hover")}else{if(b3.hasClass("gq-a-name")){b3.siblings(".gq-a-icon").addClass("gq-a-delete")}}});a6.mouseout(function(b2){var b3=$(b2.target);if(b3.hasClass("gq-a-icon")){b3.removeClass("gq-a-delete-hover")}else{if(b3.hasClass("gq-a-name")){b3.siblings(".gq-a-icon").removeClass("gq-a-delete")}}})};var be=function(b4){var b2=b4.assignees.length;if(b2>0){for(var b3=0;b3<b2;b3++){GQueues.AssignFilter.updateAssignFilter(b4.assignees[b3].email,b4.assignees[b3].filterName)}}};var ay=function(b2){if($("#gqAssignments table .gq-a-name[title='"+b2+"']").length===0){var b3=$("#gqAssignments table tr:last");b3.find(".gq-a-name").text(b2).attr("title",b2);b3.find(".gq-a-icon").removeClass("gq-a-adding").addClass("gq-a-open").html("")}k.addClass("gq-hidden")};var aN=function(){GQueues.TagFilter.init();$("#gqAddTag").click(function(b4){var b5=$(b4.target);GQueues.TagFilter.setCallback(ac);GQueues.TagFilter.toggle(b5);var b7=b5.position();var b6=$("#gqTagFilter");b6.css("top",Math.round(b7.top+b5.outerHeight()));b6.css("left",Math.round(b7.left-b6.outerWidth()+b5.outerWidth()));if(!b6.hasClass("gq-hidden")){var b3=b6.height();var b2=b6.position().top+b3-bW.height();if(b2>0){k.height(b2+20).removeClass("gq-hidden");$("html").bind("click.tagFilter",function(b8){if(b5.parents("#gqTagFilter").length===0){k.addClass("gq-hidden")}})}}else{k.addClass("gq-hidden")}return false});R.click(function(b2){var b3=$(b2.target);if(b3.hasClass("gq-i-tag-delete")){b3.parents(".gq-i-tag:first").remove()}});R.mouseover(function(b2){var b3=$(b2.target);if(b3.hasClass("gq-i-tag-delete")){b3.addClass("gq-i-tag-hover")}});R.mouseout(function(b2){var b3=$(b2.target);if(b3.hasClass("gq-i-tag-delete")){b3.removeClass("gq-i-tag-hover")}})};var bz=function(b4){var b3=b4.tags.length;if(b3>0){for(var b2=0;b2<b3;b2++){GQueues.TagFilter.createTagFromText(b4.tags[b2],true)}}};var ac=function(){R.find(".gq-i-tag-content").attr("title","");R.find(".gq-i-tag-delete").attr("title","Remove tag");k.addClass("gq-hidden")};var aj=function(){aw.click(bp);bq.datepicker({onSelect:bX,minDate:new Date(1900,1,1)});aY=new GQueues.InputMenu({el:$("#gqDateInputMenu"),readonly:false,inputChangeHandler:bQ,placeholderText:"Set a date",tabindex:7});var b2=[{itemValue:"noTime",itemText:"No time",itemHandler:bC},{itemValue:"12:00 AM",itemText:"12:00 AM"},{itemValue:"12:30 AM",itemText:"12:30 AM"},{itemValue:"1:00 AM",itemText:"1:00 AM"},{itemValue:"1:30 AM",itemText:"1:30 AM"},{itemValue:"2:00 AM",itemText:"2:00 AM"},{itemValue:"2:30 AM",itemText:"2:30 AM"},{itemValue:"3:00 AM",itemText:"3:00 AM"},{itemValue:"3:30 AM",itemText:"3:30 AM"},{itemValue:"4:00 AM",itemText:"4:00 AM"},{itemValue:"4:30 AM",itemText:"4:30 AM"},{itemValue:"5:00 AM",itemText:"5:00 AM"},{itemValue:"5:30 AM",itemText:"5:30 AM"},{itemValue:"6:00 AM",itemText:"6:00 AM"},{itemValue:"6:30 AM",itemText:"6:30 AM"},{itemValue:"7:00 AM",itemText:"7:00 AM"},{itemValue:"7:30 AM",itemText:"7:30 AM"},{itemValue:"8:00 AM",itemText:"8:00 AM"},{itemValue:"8:30 AM",itemText:"8:30 AM"},{itemValue:"9:00 AM",itemText:"9:00 AM"},{itemValue:"9:30 AM",itemText:"9:30 AM"},{itemValue:"10:00 AM",itemText:"10:00 AM"},{itemValue:"10:30 AM",itemText:"10:30 AM"},{itemValue:"11:00 AM",itemText:"11:00 AM"},{itemValue:"11:30 AM",itemText:"11:30 AM"},{itemValue:"12:00 PM",itemText:"12:00 PM"},{itemValue:"12:30 PM",itemText:"12:30 PM"},{itemValue:"1:00 PM",itemText:"1:00 PM"},{itemValue:"1:30 PM",itemText:"1:30 PM"},{itemValue:"2:00 PM",itemText:"2:00 PM"},{itemValue:"2:30 PM",itemText:"2:30 PM"},{itemValue:"3:00 PM",itemText:"3:00 PM"},{itemValue:"3:30 PM",itemText:"3:30 PM"},{itemValue:"4:00 PM",itemText:"4:00 PM"},{itemValue:"4:30 PM",itemText:"4:30 PM"},{itemValue:"5:00 PM",itemText:"5:00 PM"},{itemValue:"5:30 PM",itemText:"5:30 PM"},{itemValue:"6:00 PM",itemText:"6:00 PM"},{itemValue:"6:30 PM",itemText:"6:30 PM"},{itemValue:"7:00 PM",itemText:"7:00 PM"},{itemValue:"7:30 PM",itemText:"7:30 PM"},{itemValue:"8:00 PM",itemText:"8:00 PM"},{itemValue:"8:30 PM",itemText:"8:30 PM"},{itemValue:"9:00 PM",itemText:"9:00 PM"},{itemValue:"9:30 PM",itemText:"9:30 PM"},{itemValue:"10:00 PM",itemText:"10:00 PM"},{itemValue:"10:30 PM",itemText:"10:30 PM"},{itemValue:"11:00 PM",itemText:"11:00 PM"},{itemValue:"11:30 PM",itemText:"11:30 PM"},{itemValue:"customTime",itemText:"Custom",itemHandler:av}];s=new GQueues.InputMenu({el:$("#gqTimeInputMenu"),readonly:false,inputChangeHandler:a4,placeholderText:"Set a time",menuItems:b2,defaultMenuVal:bv,alternativeMenuVal:aU,contentContainer:$("#gqGmailPopup"),tabindex:8});var b4=[{itemValue:"No reminder",itemText:"No reminder"},{itemValue:"Email reminder",itemText:"Email reminder"},{itemValue:"SMS reminder",itemText:"SMS reminder"},{itemValue:"Pop-up reminder",itemText:"Pop-up reminder"}];if(!bM){b4.splice(2,1)}au=new GQueues.InputMenu({el:$("#gqReminderInputMenu"),readonly:true,inputChangeHandler:C,placeholderText:"",menuItems:b4,defaultMenuVal:aC,disabledHandler:by,contentContainer:$("#gqGmailPopup"),tabindex:10});var b3=[{itemValue:"0 minutes",itemText:"0 minutes"},{itemValue:"5 minutes",itemText:"5 minutes"},{itemValue:"10 minutes",itemText:"10 minutes"},{itemValue:"15 minutes",itemText:"15 minutes"},{itemValue:"20 minutes",itemText:"20 minutes"},{itemValue:"30 minutes",itemText:"30 minutes"},{itemValue:"45 minutes",itemText:"45 minutes"},{itemValue:"1 hour",itemText:"1 hour"},{itemValue:"2 hours",itemText:"2 hours"},{itemValue:"3 hours",itemText:"3 hours"},{itemValue:"6 hours",itemText:"6 hours"},{itemValue:"12 hours",itemText:"12 hours"},{itemValue:"1 day",itemText:"1 day"},{itemValue:"2 days",itemText:"2 days"},{itemValue:"3 days",itemText:"3 days"},{itemValue:"4 days",itemText:"4 days"},{itemValue:"5 days",itemText:"5 days"},{itemValue:"6 days",itemText:"6 days"},{itemValue:"1 week",itemText:"1 week"},{itemValue:"customReminder",itemText:"Custom reminder",itemHandler:O}];E=new GQueues.InputMenu({el:$("#gqReminderAmountInputMenu"),readonly:false,inputChangeHandler:ak,placeholderText:"Set reminder",menuItems:b3,defaultMenuVal:b1,contentContainer:$("#gqGmailPopup"),tabindex:11});n=new GQueues.InputMenu({el:$("#gqDurationInputMenu"),readonly:false,inputChangeHandler:ax,placeholderText:"Duration",menuItems:[],defaultMenuVal:bi,contentContainer:$("#gqGmailPopup"),tabindex:9});aG();bh()};var a8=function(b2){aS=b2.defaultReminderType;aQ=b2.defaultReminderAmount;P=b2.defaultDateDuration;aR=b2.defaultTimeDuration;bM=true;if("smsAllowed" in b2){bM=b2.smsAllowed}bq.datepicker("option","firstDay",b2.weekStart||0)};var bp=function(){if(aw.prop("checked")){F()}else{V()}};var F=function(){at();var b2=new Date();bq.datepicker("setDate",b2);bX();if(P){bD=P}else{bD=1440}aG();bh();if(aS){bV=aS;bt=aQ;bu();if(bt){bA();E.setVisible(true)}}else{br()}$(".gq-date-heading").addClass("gq-date-heading-selected");$("#gqDateTableRow").removeClass("gq-hidden")};var V=function(){aw.removeAttr("checked");$(".gq-date-heading").removeClass("gq-date-heading-selected");$("#gqDateTableRow").addClass("gq-hidden");at();bc();br()};var at=function(){bR="";aK="";X="";bt="";bV="";h()};var bc=function(){bD=""};var bX=function(){var b3=bq.datepicker("getDate");var b2=new Date();bR=$.datepicker.formatDate("D, MM d, yy",b3);if(b3.getFullYear()!==b2.getFullYear()){aY.setInputValue($.datepicker.formatDate("D, M d, yy",b3))}else{aY.setInputValue($.datepicker.formatDate("D, M d",b3))}aY.clearErrorFlag();v();h()};var bh=function(){n.setInputValue(GQueues.CalendarUtil.getDurationDisplayAmount(bD))};var h=function(){if(bR===""){$("#gqDateSummary").text("")}else{$("#gqDateSummary").text(bR+GQueues.CalendarUtil.getFormattedTime(aK,X))}};var bQ=function(b2,b4){var b6=$.trim(b2);var b3;if(b6.length===0){b3=new Date()}else{try{b3=GQueues.CalendarUtil.parseDateInput(b6)}catch(b5){b3=null}}if(b3===null){aY.setErrorFlag();aY.selectInput();v()}else{bq.datepicker("setDate",b3);bX()}};var v=function(){if(aY.hasError()||s.hasError()||au.hasError()||E.hasError()||n.hasError()){a0.attr("disabled","disabled")}else{a0.removeAttr("disabled")}};var av=function(){ai();s.setInputValue("");s.selectInput();s.hideMenu();h()};var bC=function(){ai();s.setInputValue("");s.hideMenu();h()};var bv=function(){var b2=new Date();var b4=b2.getHours()+1;var b3="AM";if(b4>11){b3="PM";if(b4>12){b4=b4-12}}var b5=b4+":00 "+b3;return b5};var aU=function(b4){try{var b3=b4.split(" ")[1];var b2=b4.split(":")[0];return b2+":00 "+b3}catch(b5){}};var a4=function(b3,b4){var b2=$.trim(b3);var b5={};_postChanges=true;if(b2.length===0){s.clearErrorFlag();s.setInputValue("");v();ai()}else{b5=GQueues.CalendarUtil.parseTimeInput(b2);if(b5===null){s.setErrorFlag();v()}else{if(!aK){bD=aR}s.clearErrorFlag();v();aK=b5.hour;X=b5.minute;bS();h();bG();bh()}}};var ai=function(){aK="";X="";bD=P;bG();bh()};var bS=function(){var b2="";if(aK){b2=GQueues.CalendarUtil.getFormattedTimeForInput(aK,X)}s.setInputValue(b2)};var bK=function(){bD=0;n.setInputValue("");n.selectInput();n.hideMenu()};var bi=function(){if(aK){return"60"}else{return"1440"}};var bG=function(){var b3=[{itemValue:"All day",itemText:"All day"},{itemValue:"2 days",itemText:"2 days"},{itemValue:"3 days",itemText:"3 days"},{itemValue:"4 days",itemText:"4 days"},{itemValue:"5 days",itemText:"5 days"},{itemValue:"6 days",itemText:"6 days"},{itemValue:"1 week",itemText:"1 week"},{itemValue:"customDuration",itemText:"Custom duration",itemHandler:bK}];var b2=[{itemValue:"5 minutes",itemText:"5 minutes"},{itemValue:"10 minutes",itemText:"10 minutes"},{itemValue:"15 minutes",itemText:"15 minutes"},{itemValue:"20 minutes",itemText:"20 minutes"},{itemValue:"30 minutes",itemText:"30 minutes"},{itemValue:"45 minutes",itemText:"45 minutes"},{itemValue:"1 hour",itemText:"1 hour"},{itemValue:"2 hours",itemText:"2 hours"},{itemValue:"3 hours",itemText:"3 hours"},{itemValue:"6 hours",itemText:"6 hours"},{itemValue:"12 hours",itemText:"12 hours"},{itemValue:"1 day",itemText:"1 day"},{itemValue:"2 days",itemText:"2 days"},{itemValue:"3 days",itemText:"3 days"},{itemValue:"4 days",itemText:"4 days"},{itemValue:"5 days",itemText:"5 days"},{itemValue:"6 days",itemText:"6 days"},{itemValue:"1 week",itemText:"1 week"},{itemValue:"customDuration",itemText:"Custom duration",itemHandler:bK}];if(aK){n.setMenuItems(b2)}else{n.setMenuItems(b3)}};var bc=function(){bD=""};var bh=function(){n.setInputValue(GQueues.CalendarUtil.getDurationDisplayAmount(bD))};var aG=function(){if(!bD){if(aK){bD=aR}else{bD=P}}bG()};var ax=function(b3,b5){var b2=$.trim(b3);var b4=null;if(b2.length===0){if(aK){bD=60}else{bD=1440}n.clearErrorFlag();_doneBtn.removeAttr("disabled");bh()}else{b4=GQueues.CalendarUtil.parseDurationInput(b2);if(b4===null||b4===0){n.setErrorFlag();v()}else{if(!aK&&b4%1440!==0){n.setErrorFlag();v()}else{n.clearErrorFlag();v();bD=b4;bh()}}}};var C=function(b2,b3){$("#gqDateReminder").removeClass("gq-hidden");if(b2==="Email reminder"){bV="email"}else{if(b2==="SMS reminder"){bV="sms"}else{if(b2==="Pop-up reminder"){bV="alert"}else{if(b2==="No reminder"){br();return}}}}if(!bt||bt===""){if(aQ){bt=aQ}else{bt="15"}}bA();E.setVisible(true)};var ak=function(b2,b4){var b5=$.trim(b2);var b3=null;if(b5.length===0){bt=0;E.clearErrorFlag();v();bA()}else{b3=GQueues.CalendarUtil.parseReminderAmountInput(b5);if(b3===null){E.setErrorFlag();v()}else{if(b3>40320){b3=40320}E.clearErrorFlag();v();bt=b3;bA()}}};var aC=function(){return"No reminder"};var b1=function(){return""};var a7=function(){if(GQueues.config.calendarIntegration==="True"){au.setDisabled(false)}else{au.setDisabled(true)}};var bu=function(){var b2={"":"No reminder",email:"Email reminder",sms:"SMS Reminder",alert:"Pop-up reminder"};au.setInputValue(b2[bV]);if(!bV){$("#gqDateReminder").addClass("gq-hidden")}else{$("#gqDateReminder").removeClass("gq-hidden")}};var O=function(){_postChanges=true;bt=0;E.setInputValue("");E.selectInput();E.hideMenu()};var br=function(){$("#gqDateReminder").addClass("gq-hidden");bV="";bt="";E.clearErrorFlag();E.setVisible(false);bu()};var bA=function(){E.setInputValue(GQueues.CalendarUtil.getReminderDisplayAmount(bt))};var by=function(){_reminderNoticeVisible=true;GQueues.MessageBox.show({title:"Task Reminders",text:"To set task reminders first activate Google Calendar integration.<br /><br /><a target='_blank' href='https://www.gqueues.com/help/tasks#reminder'>More info</a>",okBtn:true,okBtnText:"OK",callback:function(){_reminderNoticeVisible=false},cancelBtn:false})};var bJ=function(){var b2="This extension is currently linked to your <span>"+T.email+"</span> GQueues acccount.";ae.html(b2);i()};var aE=function(){bf()};var S=function(){T=null;chrome.storage.sync.clear(function(){t()})};var az=function(){bO(function(){if(aZ!==null){p=true;window.open(aZ,"_blank","width=600, height=600");return}},true)};var a=function(b3){var b2=$(b3.target).prop("checked");chrome.storage.sync.set({GQ_STORAGE_EMAIL_LINK_KEY:b2},function(){bN()})};var L=function(b3){var b4=$(b3.target);var b2=b4.prop("checked");if(b2){u(b4);return}else{chrome.storage.sync.set({GQ_STORAGE_EMAIL_ORIGINAL_KEY:false},function(){bZ()})}};var u=function(b2){if(p){bO(function(){u(b2)});return}if(aZ!==null){p=true;b2.prop("checked",false);b2.parent().removeClass("gq-checked");window.open(aZ,"_blank","width=600, height=600");return}chrome.storage.sync.set({GQ_STORAGE_EMAIL_ORIGINAL_KEY:true},function(){bZ()})};var b=function(b3){var b2=$(b3.target).prop("checked");if(b2){$("#gqKeyboardShortcutWrap").addClass("gq-checked")}else{$("#gqKeyboardShortcutWrap").removeClass("gq-checked")}chrome.storage.sync.set({GQ_STORAGE_KEYBOARD_SHORTCUT_KEY:b2},function(){aD()})};var bd=function(){var b2=o.val();chrome.storage.sync.set({GQ_STORAGE_DEFAULT_QUEUE_KEY:b2},function(){aT(A)})};var bO=function(b4,b2){p=false;var b3={};if(b2){b3={reauthorize:1}}$.ajax({type:"GET",cache:false,url:ah,data:b3,dataType:"json",success:function(b5){if(b5.authUrl){aZ=b5.authUrl;chrome.storage.sync.set({GQ_STORAGE_EMAIL_ORIGINAL_KEY:false},function(){bZ()})}else{if(b5.authorized){aZ=null}}},error:function(b5,b7,b6){},complete:function(){if(b4!==undefined){b4()}}})};var a1=function(b2){chrome.storage.sync.get("GQ_STORAGE_USER_KEY",function(b4){var b3=b4.GQ_STORAGE_USER_KEY;if(b3===undefined||b3===null){if(b2){b2(false)}return}T=b3;if(b2){b2(true)}})};var bk=function(){D.one("mouseenter",function(){bn=$(this).find("> div:first").get(0).className})};var aa=function(){chrome.storage.sync.get("GQ_WELCOME_SHOWN",function(b2){var b3=b2.GQ_WELCOME_SHOWN;if(b3===undefined||b3===null||!b3){am(0);chrome.storage.sync.set({GQ_WELCOME_SHOWN:true},function(){})}})};var bF=function(){$("#gqWrongPopup").remove();$("body").append(bl);aV=$("#gqWrongPopup");bL=$("#gqWrongCloseBtn");aV.find(".linked-email").text(T.email);aV.find(".curr-email").text(bU);var b2=Math.round(($(window).height()-aV.height())/2);var b3=Math.round(($(window).width()-aV.width())/2);aV.css("top",b2);aV.css("left",b3);bL.click(function(){aV.remove()})};var am=function(b2){if(b2>w){return}var b4=$('div[gh="mtb"] > div');if(b4.length===0){setTimeout(function(){am(b2+1)},300);return}$("#gqWelcomePopup").remove();$("body").append(ar);ag=$("#gqWelcomePopup");g=$("#gqWelcomeCloseBtn");aM=$("#gqWelcomeLearnBtn");var b3=Math.round(($(window).height()-ag.height())/2);var b5=Math.round(($(window).width()-ag.width())/2);ag.css("top",b3);ag.css("left",b5);g.click(function(){ag.remove()});aM.click(function(){window.open(a5,"_blank");ag.remove()})};var bj=function(){var b3=chrome.runtime.connect();window.addEventListener("message",function(b7){if(b7.source!=window){return}if(b7.data.type&&(b7.data.type=="FROM_GMAIL_PAGE")){J=b7.data.gmailGlobals;if(J){bU=J[10].toLowerCase()}else{var b5=document.title.split(" ");for(var b6=0;b6<b5.length;b6++){if(GQueues.Util.emailValid(b5[b6])){bU=b5[b6].toLowerCase()}}}bm()}},false);var b4="("+function(){try{window.postMessage({type:"FROM_GMAIL_PAGE",gmailGlobals:GLOBALS},"*")}catch(b5){window.postMessage({type:"FROM_GMAIL_PAGE",gmailGlobals:null},"*")}}+")();";var b2=document.createElement("script");b2.textContent=b4;(document.head||document.documentElement).appendChild(b2);b2.parentNode.removeChild(b2)};var bm=function(){a1(function(b2){if(b2){if(T&&T.email&&(T.email.toLowerCase()===bU)){aL=false;j(0);aF();bO();aD();ab()}else{aL=true;aF();j(0)}}else{aF();bO();aD();j(0);ab()}})};var y=function(){bj();aa()};var W=function(b2){$(".gq-panel").addClass("gq-hidden");b2.removeClass("gq-hidden")};var ap=function(b2){a9.height($(".gq-panel:visible").height());a9.find("p:first").text(b2);W(a9)};var bg=function(){f.height($(".gq-panel:visible").height());W(f)};var a3=function(){G.height($(".gq-panel:visible").height());var b2=G.height()/2;af.css("padding-top",b2);W(G)};var i=function(){c.height($(".gq-panel:visible").height());W(c)};var bf=function(){W(M);U.focus()};return{init:function(){y()},setAuthSuccess:function(){aZ=null},visibleMenu:function(){return aH},setVisibleMenu:function(b2){aH=b2}}}();$(GQueues.init);GQueues.AjaxQueue=function(){return{addRequest:function(a){return},completeRequest:function(){return}}}();GQueues.QueueContentPanel=function(){return{addListPadding:function(){return},removeListPadding:function(){return}}}();GQueues.TagQueuesPanel=function(){return{reload:function(){return},getTagStyle:function(a){return"gq-queue-bkgnd-31"}}}();GQueues.InputMenu=function(a){this.uuid=Date.now().toString()+"-"+Math.floor((Math.random()*1000000)+1).toString();this.wrapper=a.el;this.readonly=a.readonly;this.inputChangeHandler=a.inputChangeHandler;this.inputWrap=null;this.inputEl=null;this.menuWrap=null;this.menuEl=null;this.placeholderText=a.placeholderText;this.menuItems=a.menuItems;this.defaultMenuVal=a.defaultMenuVal;this.alternativeMenuVal=a.alternativeMenuVal;this.disabledHandler=a.disabledHandler;this.tabindex=a.tabindex;this.menuTop=null;this.toolTip=a.toolTip;this.calendarMenu=a.calendarMenu;this.defaultCalVal=a.defaultCalVal;this.calendarWrap=null;this.calendarBox=null;this.calendarEl=null;this.calendarTop=null;this.minDate=null;this.calendarWeekStart=a.calendarWeekStart;this.prevValue=null;this.contentContainer=a.contentContainer;this.maxLength=a.maxLength;this.init()};GQueues.InputMenu.prototype.init=function(){var a={thisObj:this};this.wrapper.addClass("gq-modern-input-menu").addClass(this.uuid);this.wrapper.append("<div class='gq-modern-input-wrap'></div>");this.inputWrap=this.wrapper.find(".gq-modern-input-wrap");this.inputWrap.append("<input class='gq-modern-input' placeholder='"+this.placeholderText+"' spellcheck='false' type='text'>");this.inputEl=this.inputWrap.find(".gq-modern-input");if(this.tabindex){this.inputEl.attr("tabindex",this.tabindex)}if(this.maxLength){this.inputEl.attr("maxlength",this.maxLength)}if(this.calendarMenu){this.inputWrap.addClass("calendar");this.wrapper.append("<div class='gq-modern-calendar-wrap gq-hidden'><div class='gq-modern-calendar-box'><div class='gq-modern-calendar'></div></div></div>");this.calendarWrap=this.wrapper.find(".gq-modern-calendar-wrap");this.calendarBox=this.wrapper.find(".gq-modern-calendar-box");this.calendarEl=this.calendarWrap.find(".gq-modern-calendar");this.calendarEl.datepicker({onSelect:function(){a.thisObj.handleDateSelected()},firstDay:a.thisObj.calendarWeekStart||0,dayNamesMin:["S","M","T","W","T","F","S"],minDate:new Date(1900,1,1)})}else{if(this.menuItems){this.inputWrap.addClass("menu");this.wrapper.append("<div class='gq-modern-menu-wrap gq-hidden'></div>");this.menuWrap=this.wrapper.find(".gq-modern-menu-wrap");this.menuWrap.append("<div class='gq-modern-menu'></div>");this.menuEl=this.menuWrap.find(".gq-modern-menu");this.setMenuItems(this.menuItems);this.menuEl.bind("mouseover",a,function(b){var c=$(b.target);if(c&&c.hasClass("gq-modern-menu-item")&&!c.hasClass("highlighted")){b.data.thisObj.menuEl.find(".highlighted").removeClass("highlighted");c.addClass("highlighted")}});this.menuEl.bind("mouseout",a,function(b){var c=$(b.target);if(c&&c.hasClass("gq-modern-menu-item")){c.removeClass("highlighted")}})}}if(this.readonly){this.inputEl.attr("readonly","readonly")}else{this.inputEl.bind("change",a,function(c){var b=c.data.thisObj.inputChangeHandler;if(b&&typeof b==="function"){return b(c.data.thisObj.inputEl.val(),c)}});this.inputEl.bind("blur",a,function(c){if(c.data.thisObj.inputEl.val().length===0){var b=c.data.thisObj.inputChangeHandler;if(b&&typeof b==="function"){return b("",c)}}})}this.inputEl.bind("focus",a,function(b){b.data.thisObj.prevValue=b.data.thisObj.inputEl.val()});this.inputWrap.bind("click",a,function(c){if(c.data.thisObj.disabled){var b=c.data.thisObj.disabledHandler;if(b&&typeof b==="function"){c.preventDefault();c.stopPropagation();c.stopImmediatePropagation();return b()}}else{if(c.data.thisObj.menuIsVisible()||c.data.thisObj.calendarIsVisible()){c.data.thisObj.hideMenu();c.data.thisObj.hideCalendar()}else{c.data.thisObj.showMenu();c.data.thisObj.showCalendar()}}});this.inputEl.bind("keydown",a,function(b){if(b.keyCode!==40&&b.keyCode!==38&&b.keyCode!==13){b.data.thisObj.hideMenu();b.data.thisObj.hideCalendar()}if(b.keyCode===13&&!b.shiftKey){if((b.data.thisObj.menuWrap&&b.data.thisObj.menuWrap.hasClass("gq-hidden"))||(b.data.thisObj.calendarWrap&&b.data.thisObj.calendarWrap.hasClass("gq-hidden"))){if(b.data.thisObj.prevValue!==b.data.thisObj.inputEl.val()){b.data.thisObj.inputEl.blur();b.data.thisObj.inputEl.focus()}else{b.data.thisObj.showMenu();b.data.thisObj.showCalendar();b.preventDefault();b.stopPropagation();b.stopImmediatePropagation();return false}}}});if(this.menuWrap){this.menuWrap.bind("click",a,function(c){var b=$(c.target).closest(".gq-modern-menu-item");c.data.thisObj.handleMenuSelection(b);c.preventDefault();c.stopPropagation();c.stopImmediatePropagation()})}};GQueues.InputMenu.prototype.setMenuItems=function(b){this.menuItems=b;this.menuEl.html("");var a=0;for(a=0;a<b.length;a++){this.menuEl.append("<div class='gq-modern-menu-item' data-menu-val='"+b[a].itemValue+"'>"+b[a].itemText+"</div>")}};GQueues.InputMenu.prototype.showMenu=function(){if(!this.menuWrap){return}this.menuWrap.removeClass("gq-hidden");this.menuEl.scrollTop(0);this.menuEl.css("top",0);this.menuEl.find(".highlighted").removeClass("highlighted");this.menuTop=this.menuEl.offset().top;var e=this.menuEl.outerHeight();var a=$(window).height();if(this.contentContainer){a=this.contentContainer.height();this.menuTop=this.menuTop-this.contentContainer.offset().top}var d=this.wrapper.outerHeight();if(this.menuTop+e>a){var i=(e*-1)-d-10;this.menuEl.css("top",i)}var h=this.inputEl.val();if(!h&&this.defaultMenuVal){h=this.defaultMenuVal()}var b=this.menuEl.find('.gq-modern-menu-item[data-menu-val="'+h+'"]');if(b.length===0&&this.alternativeMenuVal){b=this.menuEl.find('.gq-modern-menu-item[data-menu-val="'+this.alternativeMenuVal(h)+'"]')}if(b.length===0){b=this.menuEl.find(".gq-modern-menu-item:first")}if(b.length>0){var j=b.position().top;this.menuEl.scrollTop(j);b.addClass("highlighted")}var f={thisObj:this};var g="click."+this.uuid;$("html").bind(g,f,function(l){var m=$(l.target);var k=m.closest("."+l.data.thisObj.uuid);if(k.length===0){l.data.thisObj.hideMenu()}});var c="keydown."+this.uuid;$(document).bind(c,f,function(l){if(l.keyCode===40){l.data.thisObj.nextMenuItem();l.preventDefault();l.stopPropagation();l.stopImmediatePropagation();return false}else{if(l.keyCode===38){l.data.thisObj.prevMenuItem();l.preventDefault();l.stopPropagation();l.stopImmediatePropagation();return false}else{if(l.keyCode===13){var k=l.data.thisObj.menuEl.find(".gq-modern-menu-item.highlighted:first");if(k.length){l.data.thisObj.handleMenuSelection(k)}l.data.thisObj.hideMenu();l.preventDefault();l.stopPropagation();l.stopImmediatePropagation();return false}}}})};GQueues.InputMenu.prototype.hideMenu=function(){if(!this.menuWrap){return}this.menuWrap.addClass("gq-hidden");var a="keydown."+this.uuid;var b="click."+this.uuid;$("html").unbind(b);$(document).unbind(a)};GQueues.InputMenu.prototype.menuIsVisible=function(){if(!this.menuWrap){return false}if(this.menuWrap.hasClass("gq-hidden")){return false}else{return true}};GQueues.InputMenu.prototype.nextMenuItem=function(){var c=false;var f=this.menuEl.find(".gq-modern-menu-item.highlighted");if(f.length){f.nextAll(".gq-modern-menu-item:first").addClass("highlighted");f.removeClass("highlighted")}else{var g=this.inputEl.val();if(!g){g=this.defaultMenuVal()}var b=this.menuEl.find('.gq-modern-menu-item[data-menu-val="'+g+'"]');if(b.length===0&&this.alternativeMenuVal){b=this.menuEl.find('.gq-modern-menu-item[data-menu-val="'+this.alternativeMenuVal(g)+'"]')}b.addClass("highlighted")}if(!this.menuEl.find(".gq-modern-menu-item.highlighted").length){this.menuEl.find(".gq-modern-menu-item:first").addClass("highlighted");c=true}var a=this.menuEl.find(".highlighted");if(c){this.menuEl.stop().clearQueue().animate({scrollTop:0},500,"swing")}else{if(a.length){var e=30;var d=a.offset().top-this.menuTop;if(d+a.height()+e>this.menuEl.height()){this.menuEl.stop().clearQueue().animate({scrollTop:this.menuEl.scrollTop()+Math.floor(this.menuEl.height()/2)-e},500,"swing")}}}};GQueues.InputMenu.prototype.prevMenuItem=function(){var c=false;var g=this.menuEl.find(".gq-modern-menu-item.highlighted");if(g.length){g.prevAll(".gq-modern-menu-item:first").addClass("highlighted");g.removeClass("highlighted")}if(!this.menuEl.find(".gq-modern-menu-item.highlighted").length){this.menuEl.find(".gq-modern-menu-item:last").addClass("highlighted");c=true}var b=this.menuEl.find(".highlighted");if(c){var a=this.menuEl.find(".gq-modern-menu-item");var e=a.length*a.first().outerHeight();this.menuEl.stop().clearQueue().animate({scrollTop:e},500,"swing")}else{if(b.length){var f=20;var d=b.offset().top-this.menuTop;if(d<f){this.menuEl.stop().clearQueue().animate({scrollTop:this.menuEl.scrollTop()-Math.floor(this.menuEl.height()/2)+f},500,"swing")}}}};GQueues.InputMenu.prototype.handleMenuSelection=function(c){var d=c.attr("data-menu-val");var a;var b;for(b=0;b<this.menuItems.length;b++){if(this.menuItems[b].itemValue===d){a=this.menuItems[b].itemHandler;break}}if(a){a()}else{this.prevValue=d;this.inputEl.val(d);if(this.toolTip){this.inputWrap.attr("title",d)}this.menuWrap.addClass("gq-hidden");this.inputChangeHandler(this.inputEl.val(),null)}};GQueues.InputMenu.prototype.showCalendar=function(){if(!this.calendarWrap){return}this.calendarWrap.removeClass("gq-hidden");this.calendarBox.css("top",0);this.calendarTop=this.calendarBox.offset().top;var i=this.calendarBox.outerHeight();var h=$(window).height();if(this.contentContainer){h=this.contentContainer.height();this.menuTop=this.menuTop-this.contentContainer.offset().top}var d=this.wrapper.outerHeight();if(this.calendarTop+i>h){var a=(i*-1)-d-5;this.calendarBox.css("top",a)}if(this.defaultCalVal&&typeof this.defaultCalVal==="function"){try{var c=this.defaultCalVal();this.calendarEl.datepicker("setDate",c)}catch(f){this.calendarEl.datepicker("setDate",new Date())}}else{this.calendarEl.datepicker("setDate",new Date())}var g={thisObj:this};var b="click."+this.uuid;$("html").bind(b,g,function(j){var k=$(j.target);var e=k.closest("."+j.data.thisObj.uuid);if(e.length===0&&k.closest(".ui-datepicker-prev").length===0&&k.closest(".ui-datepicker-next").length===0&&k.parents(".ui-datepicker-calendar").length===0){j.data.thisObj.hideCalendar();$("html").unbind(b)}})};GQueues.InputMenu.prototype.hideCalendar=function(){if(!this.calendarWrap){return}this.calendarWrap.addClass("gq-hidden");var a="keydown."+this.uuid;$(document).unbind(a)};GQueues.InputMenu.prototype.calendarIsVisible=function(){if(!this.calendarWrap){return false}if(this.calendarWrap.hasClass("gq-hidden")){return false}else{return true}};GQueues.InputMenu.prototype.setCalendarMinDate=function(a){this.minDate=a;this.calendarEl.datepicker("option","minDate",this.minDate)};GQueues.InputMenu.prototype.handleDateSelected=function(){var a=this.calendarEl.datepicker("getDate");a=$.datepicker.formatDate("M d, yy",a);this.inputEl.val(a);this.calendarWrap.addClass("gq-hidden");this.inputChangeHandler(this.inputEl.val(),null)};GQueues.InputMenu.prototype.getInputValue=function(){return this.inputEl.val()};GQueues.InputMenu.prototype.setInputValue=function(a){this.inputEl.val(a);if(this.toolTip){this.inputWrap.attr("title",a)}};GQueues.InputMenu.prototype.selectInput=function(){this.inputEl.select()};GQueues.InputMenu.prototype.focusInput=function(){this.inputEl.focus()};GQueues.InputMenu.prototype.setErrorFlag=function(){this.inputEl.addClass("error");this.inputEl.select()};GQueues.InputMenu.prototype.clearErrorFlag=function(){this.inputEl.removeClass("error")};GQueues.InputMenu.prototype.hasError=function(){return this.inputEl.hasClass("error")};GQueues.InputMenu.prototype.setDisabled=function(a){this.disabled=a;if(a){this.inputWrap.addClass("disabled")}else{this.inputWrap.removeClass("disabled")}};GQueues.InputMenu.prototype.setVisible=function(a){if(a){this.wrapper.removeClass("gq-invisible")}else{this.wrapper.addClass("gq-invisible")}};GQueues.InputMenu.prototype.setCalendarWeekStart=function(a){this.calendarEl.datepicker("option","firstDay",a)};GQueues.TagFilter=function(){var b;var j;var l;var a;var y;var s;var t="create / add";var w=null;var z=null;var q;var p=null;var B=function(){a.removeClass("gq-hidden");y.removeClass("gq-hidden");s.addClass("gq-hidden").html("").attr("raw","");j.val(t).addClass("gq-tf-label");$("#gqTagFilter li").removeClass("gq-tf-hover");$("#gqTagFilter .gq-tf-tag").each(function(){var F=$(this);F.text(F.attr("raw")).removeClass("gq-hidden")});var E=j.get(0);if(E.setSelectionRange){E.focus();E.setSelectionRange(0,0)}else{if(E.createTextRange){var D=E.createTextRange();D.collapse(true);D.moveEnd("character",0);D.moveStart("character",0);D.select()}}};var c=function(D){if(!w||w.get(0)!==D.get(0)||b.hasClass("gq-hidden")){u(D)}else{e()}};var u=function(F){if(GQueues.visibleMenu()){GQueues.visibleMenu().hide()}GQueues.Util.beginEditMode();GQueues.setVisibleMenu(GQueues.TagFilter);w=F;q=F.parent();b.removeClass();var H=/gq-queue-bkgnd-\d\d?/i;var D=F.parents(".gq-item-row:first");if(D.length>0){var E=D.attr("className").match(H);if(!E){E=$("#gqItemList").attr("className").match(H)}if(E){b.addClass(E[0])}}var G=w.offset();b.removeClass("gq-hidden");b.css("top",G.top+w.outerHeight()-1);b.css("left",G.left-b.outerWidth()+w.outerWidth());GQueues.QueueContentPanel.addListPadding(F,b);B();f();$("html").bind("click.tagFilter",function(I){var J=$(I.target);if(J.parents("#gqTagFilter").length===0){e()}})};var e=function(){m();b.addClass("gq-hidden");j.blur();$("html").unbind("click.tagFilter");$("html").find(".gq-tag-filter-on").removeClass("gq-tag-filter-on");GQueues.QueueContentPanel.removeListPadding();GQueues.setVisibleMenu(null);GQueues.Util.finishEditMode()};var g=function(K,J,H){var F=false;var E;if(J){q=J}q.find(".gq-i-tag-content").each(function(){if(!F&&$(this).text()===K){F=true}if(!E&&K<$(this).text()){E=$(this).parent()}});if(!F){var D=l.html();if(E){E.before(D);E.prev().find(".gq-i-tag-content").text(K);E.prev().addClass(GQueues.TagQueuesPanel.getTagStyle(K)).attr("uni",GQueues.Util.getUnicodeRep(K))}else{q.append(D);q.find(":last-child .gq-i-tag-content").text(K);q.find(":last-child").addClass(GQueues.TagQueuesPanel.getTagStyle(K)).attr("uni",GQueues.Util.getUnicodeRep(K))}q.parents(".gq-item-container:first").attr("tagsExist","true");var I=K;var G=q;GQueues.AjaxQueue.addRequest(function(){x(I,G,H)})}if(p){p()}e()};var x=function(G,F,D){var E=F.parents(".gq-item-row:first").attr("id");if(!E){E=""}$.ajax({type:"POST",cache:false,url:"/tags/"+encodeURIComponent(G),data:{action:"new",key:E,clientId:GQueues.config.clientId},success:function(){if(!D){GQueues.TagQueuesPanel.reload()}},error:function(H,J,I){if(H.status===401){GQueues.MessageBox.showSessionExpired()}else{F.find(":last-child").remove();GQueues.MessageBox.show({title:"Sorry...",text:"There was a problem adding the tag.  Please try again.",okBtn:true,cancelBtn:false})}},complete:function(){GQueues.AjaxQueue.completeRequest()}})};var k=function(D){var E=D.attr("raw");if(E){C(E)}else{C(D.text())}};var C=function(D,I){var H=D.toLowerCase();var E;var K;var G=false;var J=false;var F=false;var L;$("#gqTagFilter .gq-tf-tag").each(function(){if(!F){E=$(this);K=E.text();currItemTextLower=K.toLowerCase();if(H<currItemTextLower){L=$("<li class='gq-tf-tag'>"+GQueues.Util.htmlEscape(D)+"</li>");L.attr("raw",D);E.before(L);G=true;F=true}else{if(H===currItemTextLower){D=K;J=true;F=true}}}});if(!G&&!J){L=$("<li class='gq-tf-tag'>"+GQueues.Util.htmlEscape(D)+"</li>");L.attr("raw",D);$("#gqTagFilter .gq-tf-create").before(L)}if(!I){g(D)}};var n=function(E,F){var D;$("#gqTagFilter .gq-tf-tag").each(function(){D=$(this);if(D.attr("raw")===E){D.attr("raw",F).text(F);return false}})};var i=function(E){var D;$("#gqTagFilter .gq-tf-tag").each(function(){D=$(this);if(D.attr("raw")===E){D.remove();return false}})};var v=function(){e();GQueues.Settings.show("#gqSettingsTags")};var A=function(){var D=$("#gqTagFilter li.gq-tf-hover");if(D.length){D.prevAll("li:not(.gq-tf-separator, .gq-hidden):first").addClass("gq-tf-hover");D.removeClass("gq-tf-hover")}else{$("#gqTagFilter li:not(.gq-tf-separator, .gq-hidden):last").addClass("gq-tf-hover")}};var h=function(){var D=$("#gqTagFilter li.gq-tf-hover");if(D.length){D.nextAll("li:not(.gq-tf-separator, .gq-hidden):first").addClass("gq-tf-hover");D.removeClass("gq-tf-hover")}else{$("#gqTagFilter li:not(.gq-tf-separator, .gq-hidden):first").addClass("gq-tf-hover")}};var f=function(){var H=new RegExp("(\\b)","ig");var E=null;var F=null;var D=null;var G;j.bind("keydown.tagInput",function(J){G=J.keyCode;if(G===38||(G===9&&J.shiftKey)){A();J.preventDefault();J.stopPropagation();J.stopImmediatePropagation();return false}else{if(G===40||G===9){h();J.preventDefault();J.stopPropagation();J.stopImmediatePropagation();return false}else{if(G===13){var I=$("#gqTagFilter li.gq-tf-hover:first");if(I.length){if(I.hasClass("gq-tf-create")){k(I)}else{if(I.hasClass("gq-tf-manage")){v()}else{g(I.text(),null,true)}}}else{if(j.val()===t){$(this).val("").removeClass("gq-tf-label");return}C(j.val())}}else{if(G!==16&&j.val()===t){$(this).val("").removeClass("gq-tf-label")}}}}});j.bind("keyup.tagInput",function(J){G=J.keyCode;buffer=j.val();htmlEscapedBuffer=GQueues.Util.htmlEscape(buffer);if(buffer&&buffer!==t){a.addClass("gq-hidden");y.addClass("gq-hidden");s.html('<strong>"'+htmlEscapedBuffer+'"</strong> (create tag)');s.attr("raw",buffer);s.removeClass("gq-hidden");var I=GQueues.Util.htmlEscape(buffer);I=GQueues.Util.regExpEscape(I);bufferLower=htmlEscapedBuffer.toLowerCase();$("#gqTagFilter .gq-tf-tag").each(function(){F=$(this);D=GQueues.Util.htmlEscape(F.attr("raw"));H.compile("("+I+")","ig");if(H.test(D)){if(D.toLowerCase()===bufferLower){s.addClass("gq-hidden")}F.removeClass("gq-hidden");D=D.replace(H,"<strong>$1</strong>");F.html(D)}else{F.addClass("gq-hidden")}});if(G!==9&&G!==38&&G!==40&&G!==13){$("#gqTagFilter li").removeClass("gq-tf-hover");$("#gqTagFilter li:not(.gq-tf-separator, .gq-hidden):first").addClass("gq-tf-hover")}}else{if(buffer!==t){B()}}})};var m=function(){j.unbind("keyup.tagInput");j.unbind("keydown.tagInput")};var r=function(){if(!b.hasClass("gq-hidden")){z=w.offset().top;if(z<GQueues.listViewportTop()||z+24>GQueues.listViewportBottom()){e()}else{b.css("top",w.offset().top+24)}}};var d=function(){$.ajax({type:"GET",cache:false,url:"/tags/",data:{action:"getTagFilter"},dataType:"json",success:function(D){$("#gqTagFilter .gq-tf-tag").remove();$("#gqTagFilter ul").prepend(D.tags)}})};var o=function(){b=$("#gqTagFilter");j=$("#gqTagFilter input:first");l=$("#gqTagTemplate");a=$("#gqTagFilter .gq-tf-separator");y=$("#gqTagFilter .gq-tf-manage");s=$("#gqTagFilter .gq-tf-create");b.mouseover(function(D){var E=$(D.target);if(E){if(E.get(0).nodeName==="LI"&&!E.hasClass("gq-tf-separator")){E.addClass("gq-tf-hover")}}});b.mouseout(function(D){var E=$(D.target);if(E){if(E.get(0).nodeName==="LI"){E.removeClass("gq-tf-hover")}}});b.click(function(D){var E=$(D.target);if(E){if(E.hasClass("gq-tf-manage")){v();return false}else{if(E.hasClass("gq-tf-tag")){g(E.text())}else{if(E.hasClass("gq-tf-create")){k(E)}}}}})};return{init:function(){o()},reload:function(){d()},createTagFromText:function(D){C(D,true)},updateTag:function(D,E){n(D,E)},deleteTag:function(D){i(D)},addTag:function(D,F,E){g(D,F,E)},setCallback:function(D){p=D},hide:function(){e()},toggle:function(D){c(D)},handleScroll:function(){r()}}}();GQueues.AssignFilter=function(){var b;var h;var f;var a;var u;var z;var o;var p="type email / name";var t=null;var x=null;var j;var m=null;var A=function(){a.removeClass("gq-hidden");u.removeClass("gq-hidden");o.addClass("gq-hidden").html("").attr("raw","");h.val(p).addClass("gq-tf-label");b.find("li").removeClass("gq-tf-hover");b.find(".gq-tf-option").each(function(){var G=$(this);G.text(G.attr("raw")).removeClass("gq-hidden")});var F=h.get(0);if(F.setSelectionRange){F.focus();F.setSelectionRange(0,0)}else{if(F.createTextRange){var E=F.createTextRange();E.collapse(true);E.moveEnd("character",0);E.moveStart("character",0);E.select()}}};var w=function(){b.find(".gq-tf-error").removeClass("gq-hidden");A()};var c=function(E){if(!t||t.get(0)!==E.get(0)||b.hasClass("gq-hidden")){q(E)}else{d()}};var q=function(G){if(GQueues.visibleMenu()){GQueues.visibleMenu().hide()}GQueues.Util.beginEditMode();GQueues.setVisibleMenu(GQueues.AssignFilter);t=G;j=G.siblings("table");b.removeClass();var I=/gq-queue-bkgnd-\d\d?/i;var E=G.parents(".gq-item-row:first");if(E.length>0){var F=E.attr("className").match(I);if(!F){F=$("#gqItemList").attr("className").match(I)}if(F){b.addClass(F[0])}}var H=t.offset();b.removeClass("gq-hidden");b.css("top",H.top+t.outerHeight()-1);b.css("left",H.left-b.outerWidth()+t.outerWidth());b.css("min-width",b.width());GQueues.QueueContentPanel.addListPadding(G,b);A();e();$("html").bind("click.assignFilter",function(J){var K=$(J.target);if(K.parents("#gqAssignFilter").length===0){d()}})};var d=function(){i();b.addClass("gq-hidden");h.blur();$("html").unbind("click.assignFilter");$("html").find(".gq-assign-filter-on").removeClass("gq-assign-filter-on");GQueues.QueueContentPanel.removeListPadding();GQueues.setVisibleMenu(null);GQueues.Util.finishEditMode()};var B=function(F){if(F){if(j.find(".gq-a-name[title='"+F+"']").length===0){var G=f.clone();G.find(".gq-a-icon").addClass("gq-a-adding").html("<div></div>");G=G.find("tr");j.append(G);var H=F;var E=j;if(!m){GQueues.AjaxQueue.addRequest(function(){v(H,E,G)})}}}if(m){m(F)}d()};var C=function(G,H){var K=H.toLowerCase();var E;var F;var I=false;var J=false;var L=false;b.find(".gq-tf-option").each(function(){if(!L){E=$(this);F=E.text();currItemTextLower=F.toLowerCase();if(K<currItemTextLower){E.before("<li class='gq-tf-option' raw='"+H+"' email='"+G+"'>"+H+"</li>");I=true;L=true}else{if(K===currItemTextLower){tagText=F;J=true;L=true}}}});if(!I&&!J){b.find(".gq-tf-create").before("<li class='gq-tf-option' raw='"+H+"' email='"+G+"'>"+H+"</li>")}};var v=function(E,G,F){var H=G.parents(".gq-item-row:first").attr("id");if(!H){H=""}$.ajax({type:"POST",cache:false,url:"/assignments/",data:{action:"new",key:H,email:E,clientId:GQueues.config.clientId},dataType:"json",success:function(I){l(I,F)},error:function(I,K,J){if(I.status===401){GQueues.MessageBox.showSessionExpired()}else{G.find("tr:last-child").remove();GQueues.MessageBox.show({title:"Sorry...",text:"There was a problem adding the assignment.  Please try again.",okBtn:true,cancelBtn:false})}},complete:function(){GQueues.AjaxQueue.completeRequest()}})};var l=function(G,F){if(G.error){F.find(".gq-a-comment").remove();F.find(".gq-a-name").attr("colspan","2").html(G.error);F.find(".gq-a-icon").removeClass("gq-a-adding").addClass("gq-a-error").html("");setTimeout(function(){F.remove()},3500)}else{var E=G.name;if(!E){E=G.email}F.find(".gq-a-name").text(E).attr("title",G.email);F.find(".gq-a-icon").removeClass("gq-a-adding").addClass("gq-a-open").html("");F.attr("key",G.key);F.parents(".gq-item-container:first").attr("assignExist","true");if(G.filterName){C(G.email,G.filterName)}}};var s=function(){d();GQueues.Settings.show("#gqSettingsAssignments")};var D=function(){d();GQueues.ContactsDialog.show(B)};var y=function(){var E=b.find("li.gq-tf-hover");if(E.length){E.prevAll("li:not(.gq-tf-separator, .gq-hidden):first").addClass("gq-tf-hover");E.removeClass("gq-tf-hover")}else{b.find("li:not(.gq-tf-separator, .gq-hidden):last").addClass("gq-tf-hover")}};var g=function(){var E=b.find("li.gq-tf-hover");if(E.length){E.nextAll("li:not(.gq-tf-separator, .gq-hidden):first").addClass("gq-tf-hover");E.removeClass("gq-tf-hover")}else{b.find("li:not(.gq-tf-separator, .gq-hidden):first").addClass("gq-tf-hover")}};var e=function(){var I=new RegExp("(\\b)","ig");var F=null;var G=null;var E=null;var H;h.bind("keydown.assignInput",function(K){b.find(".gq-tf-error").addClass("gq-hidden");H=K.keyCode;if(H===38||(H===9&&K.shiftKey)){y();K.preventDefault();K.stopPropagation();K.stopImmediatePropagation();return false}else{if(H===40||H===9){g();K.preventDefault();K.stopPropagation();K.stopImmediatePropagation();return false}else{if(H===13){var J=b.find("li.gq-tf-hover:first");if(J.length){if(J.hasClass("gq-tf-create")){if(GQueues.Util.emailValid(J.attr("raw"))){B(J.attr("raw"))}else{w()}}else{if(J.hasClass("gq-tf-manage")){s()}else{B(J.attr("email"))}}}else{if(GQueues.Util.emailValid(h.val())){B(h.val())}else{w()}}}else{if(H!==16&&h.val()===p){$(this).val("").removeClass("gq-tf-label")}}}}});h.bind("keyup.assignInput",function(K){buffer=h.val();htmlEscapedBuffer=GQueues.Util.htmlEscape(buffer);if(buffer&&buffer!==p){a.addClass("gq-hidden");u.addClass("gq-hidden");o.html('<strong>"'+htmlEscapedBuffer+'"</strong> (new email)');o.attr("raw",buffer);o.removeClass("gq-hidden");var J=GQueues.Util.htmlEscape(buffer);J=GQueues.Util.regExpEscape(J);bufferLower=htmlEscapedBuffer.toLowerCase();b.find(".gq-tf-option").each(function(){G=$(this);E=GQueues.Util.htmlEscape(G.attr("raw"));I.compile("("+J+")","ig");if(I.test(E)){if(E.toLowerCase()===bufferLower){o.addClass("gq-hidden")}G.removeClass("gq-hidden");E=E.replace(I,"<strong>$1</strong>");G.html(E)}else{G.addClass("gq-hidden")}});if(H!==9&&H!==38&&H!==40&&H!==13){$("#gqAssignFilter li").removeClass("gq-tf-hover");$("#gqAssignFilter li:not(.gq-tf-separator, .gq-hidden):first").addClass("gq-tf-hover")}}else{if(buffer!==p){A()}}})};var r=function(F){var E=$('#gqAssignFilter .gq-tf-option[email="'+F+'"]');E.remove()};var i=function(){h.unbind("keyup.assignInput");h.unbind("keydown.assignInput")};var n=function(){if(!b.hasClass("gq-hidden")){x=t.offset().top;if(x<GQueues.listViewportTop()||x+24>GQueues.listViewportBottom()){d()}else{b.css("top",t.offset().top+24)}}};var k=function(){b=$("#gqAssignFilter");h=$("#gqAssignFilter input:first");f=$("#gqAssignTemplate");a=$("#gqAssignFilter .gq-tf-separator");u=$("#gqAssignFilter .gq-tf-manage");z=$("#gqAssignFilter .gq-tf-contacts");o=$("#gqAssignFilter .gq-tf-create");b.mouseover(function(E){var F=$(E.target);if(F){if(F.get(0).nodeName==="LI"&&!F.hasClass("gq-tf-separator")){F.addClass("gq-tf-hover")}}});b.mouseout(function(E){var F=$(E.target);if(F){if(F.get(0).nodeName==="LI"){F.removeClass("gq-tf-hover")}}});b.click(function(E){var F=$(E.target);if(F){if(F.hasClass("gq-tf-manage")){s();return false}else{if(F.hasClass("gq-tf-contacts")){D();return false}else{if(F.hasClass("gq-tf-option")){B(F.attr("email"))}else{if(F.hasClass("gq-tf-create")){if(GQueues.Util.emailValid(F.attr("raw"))){B(F.attr("raw"))}else{w()}}}}}}})};return{init:function(){k()},updateAssignFilter:function(E,F){C(E,F)},deleteAssignee:function(E){r(E)},setCallback:function(E){m=E},hide:function(){d()},setAssignmentInfo:function(F,E){l(F,E)},toggle:function(E){c(E)},handleScroll:function(){n()}}}();GQueues.MessageBox=function(){var j=null;var i=null;var g=null;var c=function(){k();if(j&&typeof j==="function"){j()}};var a=function(){k();if(i&&typeof i==="function"){i()}};var e=function(){k();if(g&&typeof g==="function"){g()}};var h=function(m){b();var n=$("#gqMessageBox");$("#gqMessageBox .gq-dialog-title").text(m.title);$("#gqMessageBox .gq-dialog-text").html(m.text);if(m.url){$("#gqMessageBox .gq-dialog-text").load(m.url)}if(m.width){n.width(m.width)}if(m.height){n.height(m.height)}if(m.okBtnText){$("#gqMessageBoxOkBtn").text(m.okBtnText)}if(!m.okBtn){$("#gqMessageBoxOkBtn").addClass("gq-hidden")}if(m.ok2Btn){$("#gqMessageBoxOk2Btn").removeClass("gq-hidden")}if(m.ok2BtnText){$("#gqMessageBoxOk2Btn").text(m.ok2BtnText)}if(m.cancelBtnText){$("#gqMessageBoxCancelBtn").text(m.cancelBtnText)}if(!m.cancelBtn){$("#gqMessageBoxCancelBtn").addClass("gq-hidden")}if(m.callback){j=m.callback}if(m.callback2){i=m.callback2}if(m.cancelCallback){g=m.cancelCallback}if(m.scrollOverflow){var p=$(window).height()-200;$("#gqMessageBox .gq-dialog-text").css("max-height",p).css("overflow-y","auto")}n.removeClass("gq-hidden");GQueues.Util.showModalBkgnd();var o=($(window).height()-n.height())/2+$(window).scrollTop();var q=($(window).width()-n.width())/2;n.css("top",o);n.css("left",q);if(m.okBtn){$("#gqMessageBoxOkBtn").focus()}$(window).bind("keydown.msgbox",function(r){if(r.keyCode===27){k();r.preventDefault();r.stopPropagation();return false}})};var k=function(){$(window).unbind("keydown.msgbox");$("#gqMessageBox").addClass("gq-hidden");GQueues.Util.hideModalBkgnd();$(window).focus()};var b=function(){$("#gqMessageBox .gq-dialog-title").text("");$("#gqMessageBox .gq-dialog-text").text("");$("#gqMessageBoxOkBtn").removeClass("gq-hidden").text("OK");$("#gqMessageBoxCancelBtn").removeClass("gq-hidden").text("Cancel");$("#gqMessageBoxOk2Btn").addClass("gq-hidden").text("");$("#gqMessageBox").height("");$("#gqMessageBox").width("");j=null;i=null;g=null};var l=function(){h({title:"Hold up...",text:"Your session has expired, please sign in again to continue.",okBtn:true,cancelBtn:false,callback:function(){GQueues.Util.showModalBkgnd();window.location.reload(true)}})};var d=function(){h({title:"Sorry...",text:"You are not currently authorized to complete this action.",okBtn:true,cancelBtn:false,callback:function(){GQueues.Util.showModalBkgnd();window.location.reload(true)}})};var f=function(){$("#gqMessageBoxOkBtn").click(function(){c();return false});$("#gqMessageBoxOk2Btn").click(function(){a();return false});$("#gqMessageBoxCancelBtn").click(function(){e();return false})};return{init:function(){f()},show:function(m){h(m)},showSessionExpired:function(){l()},showUnauthorized:function(){d()},hide:function(){k()}}}();GQueues.Util=function(){var NO_DATE=999999999999999;var _inEditMode=0;var _refreshOnHold=false;var _tempKeyMapping={};var _convertLinks=function(text){var exp=/(\b(https?|ftp|file|brain|evernote|thunderlink):\/\/[\-A-Z0-9+&@#\/%?()=~_|!:,.;\*]*[\-A-Z0-9+&@#\/%()=~_|])/ig;var imgExp=/(?=>)([^<]*\.(JPG|JPEG|PNG|GIF|BMP|WEBP)(?=<))/ig;var linkText=text.replace(exp,'<a href="$1" target="_blank">$1</a>');var fixExp=/<img src=">/ig;linkText=linkText.replace(imgExp,'"><span$1</span><img src="$1" />');return linkText.replace(fixExp,'<img src="')};var _convertLinksForComments=function(text){var exp=/(\b(https?|ftp|file|brain|evernote|thunderlink):\/\/[\-A-Z0-9+&@#\/%?()=~_|!:,.;\*]*[\-A-Z0-9+&@#\/%()=~_|])/ig;var imgExp=/(?=>)([^<]*\.(JPG|JPEG|PNG|GIF|BMP|WEBP)(?=<))/ig;var linkText=text.replace(exp,'<a href="$1" target="_blank">$1</a>');return linkText};var _convertLineBreaks=function(text){var exp=/(\r\n|\r|\n)/g;return text.replace(exp,"$1<br />")};var _stripLineBreaks=function(text){return text.replace(/<br \/>/g,"")};var _stripTags=function(text){return text.replace(/(<([^>]+)>)/ig,"")};var _regExpEscape=function(str){return String(str).replace(/([\-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")};var _htmlEscape=function(str){return str.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var _htmlUnescape=function(str){return str.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&#39;'/g,"'").replace(/&quot;/g,'"')};var _emailValid=function(str){var emailPattern=/^([a-zA-Z0-9])+([\.a-zA-Z0-9_\-\+])*@([a-zA-Z0-9\-])+(\.[a-zA-Z0-9_\-]+)+$/;return emailPattern.test(str)};var _getUnicodeRep=function(str){var rep=[];var length=str.length;var index=0;while(index<length){rep.push(str.charCodeAt(index));index+=1}return rep.join("")};var _getTempId=function(){var tempId=new Date().getTime();tempId+="-"+Math.floor((Math.random()*1000000)+1);return tempId};var _setTempKeyMapping=function(tempKey,realKey){_tempKeyMapping[tempKey]=realKey};var _getRealKeyForTemp=function(tempKey){if(_tempKeyMapping.hasOwnProperty(tempKey)){return _tempKeyMapping[tempKey]}else{return tempKey}};var _beginEditMode=function(){_inEditMode+=1};var _finishEditMode=function(){_inEditMode-=1;if(_refreshOnHold&&!_inEditMode){_refreshOnHold=false;GQueues.AjaxQueue.addRequest(function(){GQueues.QueueContentPanel.refreshQueue()})}};var _activateTextarea=function(p_field,path,key,defaultText,charLimit,changeCallback,queueKey,prevItem,callbackBeforePost){_beginEditMode();$(".gq-field-edit textarea, .gq-field-edit input").blur();var field=p_field;var config=eval("("+field.attr("config")+")");var oldValue=field.html();var textareaValue=field.text();var fieldParent;field.addClass("gq-field-edit");var oldHeight=field.height();if(textareaValue===defaultText){textareaValue="";field.removeClass("gq-i-empty")}var newArea=$(document.createElement("textarea"));newArea.val(textareaValue);newArea.attr("rows","1");field.html(newArea);var inputField=field.find("textarea");inputField.height(oldHeight);inputField.limit({limit:charLimit,container:$("#gqQueueContentMain")});inputField.focus();inputField.focus();inputField.focus();var inputEl=inputField.get(0);if(inputEl.setSelectionRange){inputEl.focus();inputEl.select();inputEl.setSelectionRange(inputEl.selectionEnd,inputEl.selectionEnd)}else{if(inputEl.createTextRange){var range=inputEl.createTextRange();range.collapse(true);range.move("character",inputEl.value.length);range.select()}}if(!key){fieldParent=field.parents(".gq-item-row:first")}inputField.one("blur",function(){field.removeClass("gq-field-edit");var newValue=_htmlEscape($(this).val());$(this).remove();if($.trim(newValue).length<=0){field.html(defaultText);newValue="";if(oldValue===defaultText){oldValue=""}field.addClass("gq-i-empty")}else{newValue=_convertLinks(newValue);field.html(newValue)}if(newValue!==oldValue||queueKey){var fieldName=config.name;postObj={};postObj[fieldName]=newValue;postObj.clientId=GQueues.config.clientId;if(queueKey){postObj.key=queueKey}var p_path=path;var p_key=key;var p_fieldParent=fieldParent;var p_postObj=postObj;var p_changeCallback=null;var p_prevItem=prevItem;if(callbackBeforePost){if(changeCallback){changeCallback()}}else{p_changeCallback=changeCallback}GQueues.AjaxQueue.addRequest(function(){_postTextarea(p_path,p_key,p_fieldParent,p_postObj,p_changeCallback,p_prevItem)})}else{_finishEditMode()}})};var _postTextarea=function(path,key,fieldParent,postObj,changeCallback,prevItem){if(fieldParent){key=fieldParent.attr("id")}if(fieldParent&&fieldParent.parent(".gq-i-sub-items").length>0){postObj.parentKey=fieldParent.parents(".gq-item-row:first").attr("id")}if(prevItem){postObj.prevItemKey=prevItem.attr("id")}postObj.specific="True";$.ajax({type:"POST",cache:false,url:path+key,data:postObj,dataType:"json",success:function(data){_finishEditMode();if(changeCallback){changeCallback(data)}GQueues.AjaxQueue.completeRequest()},error:function(request,textStatus,errorThrown){_handleAjaxError(request,"There was a problem saving this text.  Please try again")}})};var _activateEdit=function(field,path,changeCallback){_beginEditMode();var config=eval("("+field.attr("config")+")");var oldValue=field.text();var key="";if(config.key){key=config.key}else{if(field.attr("key")){key=field.attr("key")}}field.addClass("gq-field-edit");field.html('<input type="'+config.type+'" id="'+field.attr("id")+"_"+config.type+'" maxlength="'+config.maxLength+'">');var inputField=field.find("input");inputField.val(oldValue);inputField.focus();inputField.select();inputField.one("blur change",function(){field.removeClass("gq-field-edit");var newValue=$(this).val();field.html(_htmlEscape(newValue));if(newValue!==oldValue){var fieldName=config.name;var postObj={};postObj[fieldName]=newValue;postObj.clientId=GQueues.config.clientId;if(config.nopost==="true"){_finishEditMode();if(changeCallback){changeCallback()}}else{$.ajax({type:"POST",cache:false,url:path+encodeURIComponent(key),data:postObj,success:function(data){_finishEditMode();if(changeCallback){changeCallback(data)}},error:function(request,textStatus,errorThrown){_handleAjaxError(request,"There was a problem saving this text.  Please try again")}})}}else{_finishEditMode()}})};var _expandPanel=function(target){target.removeClass("collapsed");target.parents(".gq-queue-panel-header:first").siblings("div.gq-queue-panel-content-container:first").show()};var _togglePanel=function(target){target.toggleClass("collapsed");target.parents(".gq-queue-panel-header:first").siblings("div.gq-queue-panel-content-container:first").toggle();var panel=target.parents(".gq-queue-panel:first").attr("type");$.ajax({type:"POST",url:"/settings",data:{action:"panelCollapse",panel:panel,collapse:target.hasClass("collapsed")}})};var _hidePanel=function(panelEl,hidden){if(hidden==="true"){panelEl.addClass("gq-hidden")}else{panelEl.removeClass("gq-hidden")}$.ajax({type:"POST",url:"/settings",data:{action:"panelHide",panel:panelEl.attr("type"),hidden:hidden}})};var _showObjectMenu=function(menu,menuBtn,row,key,title){if(GQueues.visibleMenu()){GQueues.visibleMenu().hide()}var hide=function(){row.removeClass("gq-menu-selected");menu.addClass("gq-hidden");$(".gq-control-content").removeClass("hover");GQueues.setVisibleMenu(null)};GQueues.setVisibleMenu({hide:hide});$("#gqControlPanel div.gq-menu-selected").removeClass("gq-menu-selected");$(".gq-control-content").addClass("hover");row.addClass("gq-menu-selected");var offset=menuBtn.offset();menu.find("div.gq-object-menu-title").html(title);menu.attr("objectKey",key);menu.css("maxHeight","");menu.css("left",-1000);menu.removeClass("gq-hidden");var viewport=$(window).height();var newTop=offset.top+14;var menuHeight=menu.outerHeight();if(newTop+menuHeight>viewport){newTop=offset.top-menuHeight}if(newTop<0){newTop=20;menu.css("maxHeight",offset.top-20);menu.scrollTop(0)}menu.css("top",newTop);menu.css("left",offset.left);$("html").one("click",hide)};var _shouldOpenInNewWindow=function(event){return(event.metaKey||event.shiftKey)&&GQueues.History.historySupported()};var _openInNewWindow=function(type,filter,queueKey){var url=GQueues.History.getHistoryUrl(type,filter,queueKey);window.open(url)};var _parseTitleDate=function(titleDate,parseTime){var textParts=[];var dateObj=null;var timeParts;var hour;var minutes;var meridian;if(titleDate){titleDate=$.trim(titleDate.split("Repeats")[0]);try{textParts=titleDate.split(" @ ");dateObj=$.datepicker.parseDate("D, MM d, yy",textParts[0]);if(parseTime&&textParts.length===2){timeParts=textParts[1].split(":");hour=parseInt(timeParts[0],10);minute=parseInt(timeParts[1].substring(0,2),10);meridian=timeParts[1].substring(3);if(meridian==="PM"&&hour<12){hour+=12}if(meridian==="AM"&&hour===12){hour=0}dateObj.setHours(hour,minute)}}catch(err){}}return dateObj};var aId;var bId;var _dateSort=function(a,b){var aDate=_parseTitleDate($(a).attr("title"),true);var bDate=_parseTitleDate($(b).attr("title"),true);if(aDate<bDate){return 1}if(aDate>bDate){return -1}if((aDate&&bDate&&aDate.valueOf()===bDate.valueOf())||(!aDate&&!bDate)){aId=$(a).parents(".gq-item-row:first, .gq-print-item-container:first").attr("id");bId=$(b).parents(".gq-item-row:first, .gq-print-item-container:first").attr("id");if(aId<bId){return 1}if(aId>bId){return -1}return 0}return 0};var aText;var bText;var _nameSort=function(a,b){aText=$(a).text().toLowerCase();bText=$(b).text().toLowerCase();if(aText<bText){return 1}if(aText>bText){return -1}if(aText===bText){aId=$(a).parents(".gq-item-row:first, .gq-print-item-container:first").attr("id");bId=$(b).parents(".gq-item-row:first, .gq-print-item-container:first").attr("id");if(aId<bId){return 1}if(aId>bId){return -1}return 0}return 0};var aOrder;var bOrder;var _originSort=function(a,b){aOrder=$(a).attr("position");bOrder=$(b).attr("position");if(aOrder<bOrder){return 1}if(aOrder>bOrder){return -1}if(aOrder===bOrder){aId=$(a).parents(".gq-item-row:first").attr("id");bId=$(b).parents(".gq-item-row:first").attr("id");if(aId<bId){return 1}if(aId>bId){return -1}return 0}return 0};var _completedSort=function(a,b){aOrder=$(a).attr("rawDate");bOrder=$(b).attr("rawDate");if(aOrder<bOrder){return 1}if(aOrder>bOrder){return -1}if(aOrder===bOrder){aId=$(a).parents(".gq-item-row:first, .gq-print-item-container:first").attr("id");bId=$(b).parents(".gq-item-row:first, .gq-print-item-container:first").attr("id");if(aId<bId){return 1}if(aId>bId){return -1}return 0}return 0};var aTags;var bTags;var aTagText;var bTagText;var tagIndex;var _tagSort=function(a,b){aTags=$(a).find(".gq-i-tag-content");bTags=$(b).find(".gq-i-tag-content");tagIndex=0;while(true){aTagText=aTags.eq(tagIndex).text().toLowerCase();bTagText=bTags.eq(tagIndex).text().toLowerCase();if(aTagText<bTagText){if(aTagText===""){return -1}return 1}if(aTagText>bTagText){if(bTagText===""){return 1}return -1}if(aTagText===bTagText){if(!aTagText){aId=$(a).parents(".gq-item-row:first, .gq-print-item-container:first").attr("id");bId=$(b).parents(".gq-item-row:first, .gq-print-item-container:first").attr("id");if(aId<bId){return 1}if(aId>bId){return -1}return 0}tagIndex+=1}}};var _headerSortReverse=function(a,b){return _headerSort(b,a)};var _headerSort=function(a,b){aText=a.sortValue;bText=b.sortValue;if(aText<bText){return 1}if(aText>bText){return -1}return 0};var aKey;var bKey;var _queueSort=function(a,b){aKey=$(a).attr("queueKey");bKey=$(b).attr("queueKey");if(aKey<bKey){return 1}if(aKey>bKey){return -1}return 0};var _groupItems=function(grouping,direction,container,currSort,itemSelector,sortSelector){var groupHeaders=[];var groupHeader;var groupHeaderEl;var groupItems;var groupTitle;var currValue=null;var currEl;var currDate;var currTime;var currTagText;var allItems=container.find(itemSelector);if(allItems.length>0){if(grouping==="date"){allItems.sort(_dateSort);allItems.each(function(i){currEl=$(this);currDate=_parseTitleDate(currEl.attr("title"),false);if(!currDate){currTime=NO_DATE}else{currTime=currDate.getTime()}if(currTime!==currValue){groupItems=[];currValue=currTime;if(currTime===NO_DATE){groupTitle="No date"}else{groupTitle=$.datepicker.formatDate("D, MM d, yy",currDate)}groupHeader=new GQueues.GroupHeader(currValue,groupTitle,groupItems,"","");groupHeaders.push(groupHeader)}groupItems.push(currEl.parents(".gq-item-row:first, .gq-print-item-container:first").find(sortSelector))})}else{if(grouping==="tag"){allItems.sort(_tagSort);allItems.each(function(i){currEl=$(this);currTagText=currEl.find(".gq-i-tag-content:first").text();if(currTagText!==currValue){groupItems=[];currValue=currTagText;if(currValue===""){groupTitle="No tags";currTagText="\uffff"}else{groupTitle=GQueues.Util.htmlEscape(currTagText)}groupHeader=new GQueues.GroupHeader(currTagText.toLowerCase(),groupTitle,groupItems,"","");groupHeaders.push(groupHeader)}groupItems.push(currEl.parents(".gq-item-row:first, .gq-print-item-container:first").find(sortSelector))})}else{if(grouping==="queue"){allItems.sort(_queueSort);allItems.each(function(i){currEl=$(this);if(currEl.attr("queueKey")!==currValue){groupItems=[];currValue=currEl.attr("queueKey");groupHeader=new GQueues.GroupHeader(currEl.attr("queueOrder"),GQueues.Util.htmlEscape(currEl.attr("title")),groupItems,currValue,currEl.attr("access"));groupHeaders.push(groupHeader)}groupItems.push(currEl.find(sortSelector))})}}}var sortFunctions=[_headerSort,_headerSortReverse];groupHeaders.sort(sortFunctions[direction]);var i;var j;var numHeaders=groupHeaders.length;var numItems;var currHeader;for(i=0;i<numHeaders;i++){currHeader=groupHeaders[i];groupHeaderEl=$(currHeader.getHeaderEl());container.prepend(groupHeaderEl);groupItems=currHeader.items;groupItems.sort(currSort);numItems=groupItems.length;for(j=0;j<numItems;j++){groupHeaderEl.after($(groupItems[j]).parents(".gq-item-row, .gq-print-item-container"))}}}};var _updateItemQueue=function(dropEl,event,ui){ui.draggable.find(".gq-item-helper-msg").remove();var itemKey=ui.draggable.attr("id");var smartQueue=ui.draggable.attr("queueKey");var queueKey=dropEl.attr("queueKey");if($("#gqQueueContent").hasClass("gq-share")){}else{ui.draggable.attr("gq-dropped",true);ui.draggable.addClass("gq-hidden");ui.helper.addClass("gq-hidden");setTimeout(function(){ui.draggable.remove();if($("#gqItemList .gq-item-row").length<=0){if($("#gqQueueContent").hasClass("gq-task")){setTimeout(function(){GQueues.QueueContentPanel.reloadQueue()},1000)}else{setTimeout(function(){GQueues.QueueContentPanel.setEmptyQueueMessage()},1000)}}else{if(!smartQueue){GQueues.QueueContentPanel.updateItemOrder(true)}}GQueues.InfoPanel.clearItemInfo();GQueues.QueueContentPanel.setQueueCount();GQueues.Util.updateQueueCount(queueKey,1)},500);GQueues.AjaxQueue.addRequest(function(){_postUpdateItemQueue(itemKey,queueKey)})}};var _postUpdateItemQueue=function(itemKey,queueKey){itemKey=GQueues.Util.getRealKeyForTemp(itemKey);$.ajax({type:"POST",url:"/items/"+itemKey,data:{action:"updateItemQueue",queueKey:queueKey,clientId:GQueues.config.clientId},error:function(request,textStatus,errorThrown){GQueues.Util.handleAjaxError(request,"There was a problem moving the item to a new queue.  Please try again.")},complete:function(){GQueues.AjaxQueue.completeRequest()}})};var _updateQueueCount=function(queueKey,amount){var queueCounter=$("#"+queueKey+" .gq-queue-count");if(queueCounter.length===0){queueCounter=$('#gqControlPanel .gq-queue-row[queueKey="'+queueKey+'"] .gq-queue-count')}var countText=queueCounter.text().replace(/[()]/,"");var newCount=parseInt(countText,10)+amount;queueCounter.text("("+newCount+")")};var _setQueueCount=function(queueKey,count){var queueCounter=$('#gqControlPanel .gq-queue-row[queueKey="'+queueKey+'"] .gq-queue-count');queueCounter.text("("+count+")")};var _handleAjaxError=function(request,msg){if(request&&request.status===401){GQueues.MessageBox.showSessionExpired()}else{if(request&&request.status===403){GQueues.MessageBox.showUnauthorized()}else{GQueues.MessageBox.show({title:"Sorry...",text:msg,okBtn:true,cancelBtn:false,callback:function(){GQueues.Util.showModalBkgnd();window.location.reload(true)}})}}};var _addMonths=function(startDate,numMonths){var endDate=new Date();var endMonth=startDate.getMonth()+numMonths;var endYear=startDate.getFullYear()+Math.floor(endMonth/12);if(endMonth>11){endMonth=endMonth%12}else{if(endMonth<0){endMonth=((endMonth%12)+12)%12}}endDate.setFullYear(endYear,endMonth,startDate.getDate());while(endDate.getMonth()!==endMonth){endDate.setDate(endDate.getDate()-1)}return endDate};var _addDays=function(startDate,numDays){var endDate=new Date();endDate.setFullYear(startDate.getFullYear(),startDate.getMonth(),startDate.getDate()+numDays);return endDate};var _setSelectionRange=function(input,selectionStart,selectionEnd){if(input.setSelectionRange){input.focus();input.setSelectionRange(selectionStart,selectionEnd)}else{if(input.createTextRange){var range=input.createTextRange();range.collapse(true);range.moveEnd("character",selectionEnd);range.moveStart("character",selectionStart);range.select()}}};var _setCaretToPos=function(input,pos){_setSelectionRange(input,pos,pos)};return{inEditMode:function(){return _inEditMode},beginEditMode:function(){_beginEditMode()},finishEditMode:function(){_finishEditMode()},resetEditMode:function(){_inEditMode=0},setRefreshOnHold:function(){_refreshOnHold=true},activateEdit:function(field,path,changeCallback){_activateEdit(field,path,changeCallback)},activateTextarea:function(field,path,key,defaultText,charLimit,changeCallback,queueKey,prevItem,callbackBeforePost){_activateTextarea(field,path,key,defaultText,charLimit,changeCallback,queueKey,prevItem,callbackBeforePost)},togglePanel:function(target){_togglePanel(target)},hidePanel:function(panelEl,hidden){_hidePanel(panelEl,hidden)},expandPanel:function(target){_expandPanel(target)},showObjectMenu:function(menu,menuBtn,row,key,title){_showObjectMenu(menu,menuBtn,row,key,title)},shouldOpenInNewWindow:function(event){return _shouldOpenInNewWindow(event)},openInNewWindow:function(type,filter,queueKey){_openInNewWindow(type,filter,queueKey)},regExpEscape:function(str){return _regExpEscape(str)},htmlEscape:function(str){return _htmlEscape(str)},htmlUnescape:function(str){return _htmlUnescape(str)},convertLineBreaks:function(str){return _convertLineBreaks(str)},stripLineBreaks:function(str){return _stripLineBreaks(str)},stripTags:function(str){return _stripTags(str)},convertLinks:function(str){return _convertLinks(str)},convertLinksForComments:function(str){return _convertLinksForComments(str)},emailValid:function(str){return _emailValid(str)},getUnicodeRep:function(str){return _getUnicodeRep(str)},getTempId:function(){return _getTempId()},setTempKeyMapping:function(tempKey,realKey){_setTempKeyMapping(tempKey,realKey)},getRealKeyForTemp:function(tempKey){return _getRealKeyForTemp(tempKey)},showModalBkgnd:function(opacity){if(!opacity){opacity=0.2}$("#gqModalBkgnd").css("opacity",opacity);$("#gqModalBkgnd").height($(document).height());$("#gqModalBkgnd").removeClass("gq-hidden")},hideModalBkgnd:function(){$("#gqModalBkgnd").addClass("gq-hidden")},dateSort:function(a,b){return _dateSort(a,b)},dateSortReverse:function(a,b){return _dateSort(b,a)},nameSort:function(a,b){return _nameSort(a,b)},nameSortReverse:function(a,b){return _nameSort(b,a)},originSort:function(a,b){return _originSort(a,b)},originSortReverse:function(a,b){return _originSort(b,a)},completedSort:function(a,b){return _completedSort(a,b)},completedSortReverse:function(a,b){return _completedSort(b,a)},tagSort:function(a,b){return _tagSort(a,b)},tagSortReverse:function(a,b){return _tagSort(b,a)},queueSort:function(a,b){return _queueSort(a,b)},groupItems:function(grouping,direction,container,currSort,itemSelector,sortSelector){_groupItems(grouping,direction,container,currSort,itemSelector,sortSelector)},addMonths:function(startDate,numMonths){return _addMonths(startDate,numMonths)},addDays:function(startDate,numDays){return _addDays(startDate,numDays)},updateQueueCount:function(queueKey,amount){return _updateQueueCount(queueKey,amount)},setQueueCount:function(queueKey,count){_setQueueCount(queueKey,count)},updateItemQueue:function(dropEl,event,ui){_updateItemQueue(dropEl,event,ui)},postUpdateItemQueue:function(itemKey,queueKey){_postUpdateItemQueue(itemKey,queueKey)},handleAjaxError:function(request,msg){_handleAjaxError(request,msg)}}}();GQueues.CalendarUtil=function(){var o=60;var r=1440;var b=10080;var j=function(v,w){var u=v.find("> .gq-item-container .gq-i-date");if(!u.find(".gq-i-repeat").hasClass("gq-hidden")){return}GQueues.AjaxQueue.addRequest(function(){a(v,w)})};var a=function(v,y){var x=v.attr("id");var u=v.find("> .gq-item-container .gq-i-date");var w=u.find(".gq-i-date-text");x=GQueues.Util.getRealKeyForTemp(x);$.ajax({type:"POST",cache:false,dataType:"json",data:{action:"pushDate",days:y,clientId:GQueues.config.clientId},url:"/items/"+x,success:function(z){u.attr("title",z.titleDate);w.text(z.displayDate);u.removeClass("gq-i-date-btn");u.removeClass("overdue today");if(z.reminder){u.find(".gq-i-reminder").removeClass("gq-hidden")}},error:function(z,B,A){GQueues.Util.handleAjaxError(z,"There was a problem setting the date.  Please try again.")},complete:function(){GQueues.AjaxQueue.completeRequest()}})};var g=function(u){var v=u;var w=v+" minute";if(u!==0){if(u%b===0){v=(u/b);w=v+" week"}else{if(u%r===0){v=(u/r);w=v+" day"}else{if(u%o===0){v=(u/o);w=v+" hour"}}}}if(v!==1){w+="s"}return w};var k=function(u){var v=u;if(u===65){v=o*2}else{if(u===70){v=o*4}else{if(u===75){v=o*8}else{if(u===80){v=r}else{if(u===85){v=r*2}else{if(u===90){v=r*3}else{if(u===95){v=r*4}else{if(u===100){v=r*5}else{if(u===105){v=r*6}else{if(u===110){v=b}}}}}}}}}}return v};var c=function(v){var u=v;if(v>=b){u=110}else{if(v>=r*6){u=105}else{if(v>=r*5){u=100}else{if(v>=r*4){u=95}else{if(v>=r*3){u=90}else{if(v>=r*2){u=85}else{if(v>=r){u=80}else{if(v>=o*8){u=75}else{if(v>=o*4){u=70}else{if(v>=o*2){u=65}}}}}}}}}}return u};var n=function(v){var u=v;var w=u+" minute";if(v!==0){if(v%b===0){u=(v/b);w=u+" week"}else{if(v%r===0){u=(v/r);w=u+" day";if(u===1){w="All day"}}else{if(v%o===0){u=(v/o);w=u+" hour"}}}}if(u!==1){w+="s"}return w};var h=function(u){var v={"5":5,"10":10,"15":15,"20":30,"25":45,"30":60,"35":90,"40":120,"45":180,"50":240,"55":300,"60":360,"65":420,"70":480,"75":720,"80":1440,"85":2880,"90":4320,"95":5760,"100":7200,"105":8640,"110":10080,"115":20160,"120":30240,"125":40320};return v[u]};var s=function(v){var w={"5":5,"10":10,"15":15,"30":20,"45":25,"60":30,"90":35,"120":40,"180":45,"240":50,"300":55,"360":60,"420":65,"480":70,"720":75,"1440":80,"2880":85,"4320":90,"5760":95,"7200":100,"8640":105,"10080":110,"20160":115,"30240":120,"40320":125};var u=w[v];if(!u){u=5}return u};var p=function(u){u=$.trim(u);var w=null;if(u.toLowerCase()==="all day"){return r}var z=/^(\d+) ?(m|mins?|minutes?|h|hours?|d|days?|w|weeks?)$/i;var x=u.match(z);if(x){var v=parseInt(x[1],10);var y=x[2].substr(0,1);if(y==="w"){w=v*b}else{if(y==="d"){w=v*r}else{if(y==="h"){w=v*o}else{w=v}}}}return w};var l=function(y){y=$.trim(y);var w=null;var z=/^(\d+) ?(m|mins?|minutes?|h|hours?|d|days?|w|weeks?)$/i;var u=y.match(z);if(u){var v=parseInt(u[1],10);var x=u[2].substr(0,1);if(x==="w"){w=v*b}else{if(x==="d"){w=v*r}else{if(x==="h"){w=v*o}else{w=v}}}}return w};var t=function(w){w=$.trim(w);var u=null;try{rawNum=parseInt(w,10);if(rawNum>0&&rawNum<=100){u=rawNum}}catch(v){}return u};var e=function(x,y){var w="";if(x!==""){var v=" AM";var u=x;if(x>11){v=" PM";if(x>12){u=u-12}}else{if(parseInt(x,10)===0){u=12}}w=" @ "+u+":"+y+v}return w};var d=function(x,y){var w="";if(x!==""){var v=" AM";var u=x;if(x>11){v=" PM";if(x>12){u=u-12}}else{if(parseInt(x,10)===0){u=12}}w=u+":"+y+v}return w};var q=function(v){v=$.trim(v);var A=null;var y=/^(\d\d?):?(\d\d)? ?([a|p]m?)?$/i;var B=v.match(y);if(B){A={};var z=B[1];var u=parseInt(z,10);var x="00";var w=B[3];if(B[2]){x=B[2];var C=parseInt(x,10);if(C<0||C>59){return null}}if(w&&u>12){return null}if(w){if(w.substr(0,1).toLowerCase()==="p"){if(u===12){}else{if(u<12){u+=12;z=u.toString()}else{return null}}}else{if(u===12){u=0;z=u.toString()}}}if(u<0||u>23){return null}A.hour=z;A.minute=x}return A};var m=function(C){C=$.trim(C);var D;var L;var A;var J=false;var G=new Date();var F;var K;var x;var z;var H=null;var y=/^(\d\d?[\/|\-]\d\d?)([\/|\-]\d\d|[\/|\-]\d\d\d\d)?$/i;var B=C.match(y);if(B){F=B[0].split("/");if(F.length===1){F=B[0].split("-")}if(GQueues.config.dateFormat==="littleEndian"){D=parseInt(F[0],10);L=parseInt(F[1],10)-1}else{L=parseInt(F[0],10)-1;D=parseInt(F[1],10)}if(D<1||D>31||L<0||L>11){return null}if(F.length===3){J=true;A=F[2];if(A.length===2){A="20"+A}A=parseInt(A,10)}else{A=G.getFullYear()}z=new Date(A,L,D);if(!J&&z<G){z=new Date(A+1,L,D)}H=z}else{y=/^(\d\d?)([\. ])?((jan(uary)?)|(feb(ruary)?)|(mar(ch)?)|(apr(il)?)|(may)|(jun(e)?)|(jul(y)?)|(aug(ust)?)|(sep(t)?(ember)?)|(oct(ober)?)|(nov(ember)?)|(dec(ember)?))( \d\d\d\d)?$/i;var I=C.toLowerCase().match(y);if(I){x=I[0];F=x.split(".");if(F.length===2){D=F[0];monthYear=F[1].split(" ");L=monthYear[0].substr(0,3);if(monthYear.length===2){A=monthYear[1];J=true}else{A=G.getFullYear()}}else{F=x.split(" ");if(F.length===3){D=F[0];L=F[1].substr(0,3);A=F[2];J=true}else{if(F.length===2){try{A=parseInst(F[1],10);D=F[0].substr(0,2);L=F[0].substr(2,3);J=true}catch(v){A=G.getFullYear();D=F[0];L=F[1].substr(0,3)}}else{D=F[0].substr(0,2);L=F[0].substr(2,3);A=G.getFullYear()}}}K=L+" "+D+" "+A;z=$.datepicker.parseDate("M d yy",K);if(!J&&z<G){K=L+" "+D+" "+(A+1);z=$.datepicker.parseDate("M d yy",K)}H=z}else{y=/((jan(uary)?)|(feb(ruary)?)|(mar(ch)?)|(apr(il)?)|(may)|(jun(e)?)|(jul(y)?)|(aug(ust)?)|(sep(t)?(ember)?)|(oct(ober)?)|(nov(ember)?)|(dec(ember)?)) (\d\d?)((st)|(nd)|(rd)|(th))?(,? \d\d\d\d)?$/i;var w=C.toLowerCase().match(y);if(w){x=w[0].replace(",","");F=x.split(" ");L=F[0].substr(0,3);D=F[1];if(D.length>2){D=D.substr(0,D.length-2)}if(F.length===3){J=true;A=F[2]}else{A=G.getFullYear()}K=L+" "+D+" "+A;z=$.datepicker.parseDate("M d yy",K);if(!J&&z<G){K=L+" "+D+" "+(A+1);z=$.datepicker.parseDate("M d yy",K)}H=z}else{y=/^((today)|(tomorrow)|(sun(day)?)|(mon(day)?)|(tue(s)?(day)?)|(wed(nesday)?)|(weds)|(thur?s?(day)?)|(fri(day)?)|(sat(urday)?))?$/i;var E=C.toLowerCase().match(y);if(E){D=E[0].substr(0,3);H=f(D)}else{y=/^([1-9][0-9]* (day(s)?|week(s)?))$/i;var u=C.toLowerCase().match(y);if(u){var M=u[0];H=i(M)}}}}}return H};var f=function(w){var v=new Date();var x=new Date(v.getFullYear(),v.getMonth(),v.getDate());var y=["sun","mon","tue","wed","thu","fri","sat"];if(w==="tod"){}else{if(w==="tom"){x.setDate(x.getDate()+1)}else{var u=w.substr(0,3);x.setDate(x.getDate()+1);while(y[x.getDay()]!==w){x.setDate(x.getDate()+1)}}}return x};var i=function(u){var v=new Date();var w=new Date(v.getFullYear(),v.getMonth(),v.getDate());var z=u.split(" ");var x=parseInt(z[0],10);var y=z[1];if(y.indexOf("day")!==-1){w.setDate(w.getDate()+x)}else{if(y.indexOf("week")!==-1){w.setDate(w.getDate()+(x*7))}}return w};return{pushDate:function(u,v){j(u,v)},getFormattedTime:function(u,v){return e(u,v)},getFormattedTimeForInput:function(u,v){return d(u,v)},getReminderMinutes:function(u){return k(u)},getReminderSliderAmount:function(u){return c(u)},getReminderDisplayAmount:function(u){return g(u)},getDurationMinutes:function(u){return h(u)},getDurationSliderAmount:function(u){return s(u)},getDurationDisplayAmount:function(u){return n(u)},parseTimeInput:function(u){return q(u)},parseDateInput:function(u){return m(u)},parseDurationInput:function(u){return p(u)},parseReminderAmountInput:function(u){return l(u)},parseFreqNumInput:function(u){return t(u)}}}();